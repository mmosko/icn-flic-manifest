<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>File-Like ICN Collections (FLIC)</title>
<meta content="Christian Tschudin" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="Marc Mosko" name="author">
<meta content="David Oran" name="author">
<meta content='
       This document describes how to encode an application data objet into a structured  manifest 
        using Information Centric Networking (ICN) data objects, creating a File-Like ICN Collection (FLIC).
        The manifest is an "index table" of objects that make up the manifest itself and the application data.
        It records the hash value (content object hash) of each item so a consumer using the manifest may
        request each piece by a complete hash name.  The manifest is hierarchical and may be encoded into
        realtively small ICN objects to fit within network MTU sizes.  FLIC has several methods to guide
        a consumer in constructing appropriate Interest names based on the manifest.  It also supports
        encryption of the manifest data.  FLIC may be used in CCNx or Named Data Networking, or other
        ICNs.
       
    ' name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="Information Centric Networking" name="keyword">
<meta content="draft-irtf-icnrg-flic-07" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.10.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    pydyf 0.9.0
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 75.6.0
    wcwidth 0.2.13
    weasyprint 61.2
-->
<link href="/usr/src/app/tmp/11326ef6-e8ca-4a52-ade8-b3cf7a215deb/draft-irtf-icnrg-flic-07.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">FLIC</td>
<td class="right">December 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tschudin, et al.</td>
<td class="center">Expires 5 June 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ICNRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-icnrg-flic-07</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-12-02" class="published">2 December 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-06-05">5 June 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Tschudin</div>
<div class="org">University of Basel</div>
</div>
<div class="author">
      <div class="author-name">C.A. Wood</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">M.E. Mosko</div>
</div>
<div class="author">
      <div class="author-name">D. Oran, <span class="editor">Ed.</span>
</div>
<div class="org">Network Systems Research &amp; Design</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">File-Like ICN Collections (FLIC)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes how to encode an application data objet into a structured <em>manifest</em>
        using Information Centric Networking (ICN) data objects, creating a File-Like ICN Collection (FLIC).
        The manifest is an "index table" of objects that make up the manifest itself and the application data.
        It records the hash value (content object hash) of each item so a consumer using the manifest may
        request each piece by a complete hash name.  The manifest is hierarchical and may be encoded into
        realtively small ICN objects to fit within network MTU sizes.  FLIC has several methods to guide
        a consumer in constructing appropriate Interest names based on the manifest.  It also supports
        encryption of the manifest data.  FLIC may be used in CCNx or Named Data Networking, or other
        ICNs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 June 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-flic-as-an-icn-experimental" class="internal xref">FLIC as an ICN experimental tool</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-design-overview" class="internal xref">Design Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-flic-structure" class="internal xref">FLIC Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-locators" class="internal xref">Locators</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-name-constructors" class="internal xref">Name Constructors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-manifest-metadata" class="internal xref">Manifest Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-pointer-annotations" class="internal xref">Pointer Annotations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-manifest-grammar-abnf" class="internal xref">Manifest Grammar (ABNF)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-manifest-trees" class="internal xref">Manifest Trees</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="auto internal xref">3.7.1</a>.  <a href="#name-traversal" class="internal xref">Traversal</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-manifest-encryption-modes" class="internal xref">Manifest Encryption Modes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.1">
                    <p id="section-toc.1-1.3.2.8.2.1.1"><a href="#section-3.8.1" class="auto internal xref">3.8.1</a>.  <a href="#name-aead-mode" class="internal xref">AEAD Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.2">
                    <p id="section-toc.1-1.3.2.8.2.2.1"><a href="#section-3.8.2" class="auto internal xref">3.8.2</a>.  <a href="#name-rsa-oaep-key-transport-mode" class="internal xref">RSA-OAEP Key Transport Mode</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="auto internal xref">3.9</a>.  <a href="#name-protocol-encodings" class="internal xref">Protocol Encodings</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.1">
                    <p id="section-toc.1-1.3.2.9.2.1.1"><a href="#section-3.9.1" class="auto internal xref">3.9.1</a>.  <a href="#name-ccnx-encoding" class="internal xref">CCNx Encoding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.1.2.1">
                        <p id="section-toc.1-1.3.2.9.2.1.2.1.1"><a href="#section-3.9.1.1" class="auto internal xref">3.9.1.1</a>.  <a href="#name-ccnx-hash-naming-strategy" class="internal xref">CCNx Hash Naming Strategy</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.1.2.2">
                        <p id="section-toc.1-1.3.2.9.2.1.2.2.1"><a href="#section-3.9.1.2" class="auto internal xref">3.9.1.2</a>.  <a href="#name-ccnx-single-prefix-strategy" class="internal xref">CCNx Single Prefix Strategy</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.1.2.3">
                        <p id="section-toc.1-1.3.2.9.2.1.2.3.1"><a href="#section-3.9.1.3" class="auto internal xref">3.9.1.3</a>.  <a href="#name-ccnx-segmented-prefix-strat" class="internal xref">CCNx Segmented Prefix Strategy</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.1.2.4">
                        <p id="section-toc.1-1.3.2.9.2.1.2.4.1"><a href="#section-3.9.1.4" class="auto internal xref">3.9.1.4</a>.  <a href="#name-ccnx-hybrid-strategy" class="internal xref">CCNx Hybrid Strategy</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.1.2.5">
                        <p id="section-toc.1-1.3.2.9.2.1.2.5.1"><a href="#section-3.9.1.5" class="auto internal xref">3.9.1.5</a>.  <a href="#name-ccnx-tlv-encodings" class="internal xref">CCNx TLV Encodings</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.2">
                    <p id="section-toc.1-1.3.2.9.2.2.1"><a href="#section-3.9.2" class="auto internal xref">3.9.2</a>.  <a href="#name-ndn-encoding" class="internal xref">NDN Encoding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.2.2.1">
                        <p id="section-toc.1-1.3.2.9.2.2.2.1.1"><a href="#section-3.9.2.1" class="auto internal xref">3.9.2.1</a>.  <a href="#name-ndn-hash-naming" class="internal xref">NDN Hash Naming</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.2.2.2">
                        <p id="section-toc.1-1.3.2.9.2.2.2.2.1"><a href="#section-3.9.2.2" class="auto internal xref">3.9.2.2</a>.  <a href="#name-ndn-single-prefix" class="internal xref">NDN Single Prefix</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.2.2.3">
                        <p id="section-toc.1-1.3.2.9.2.2.2.3.1"><a href="#section-3.9.2.3" class="auto internal xref">3.9.2.3</a>.  <a href="#name-ndn-segmented-prefix" class="internal xref">NDN Segmented Prefix</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.2.2.4">
                        <p id="section-toc.1-1.3.2.9.2.2.2.4.1"><a href="#section-3.9.2.4" class="auto internal xref">3.9.2.4</a>.  <a href="#name-ndn-hybrid-schema" class="internal xref">NDN Hybrid Schema</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.3">
                    <p id="section-toc.1-1.3.2.9.2.3.1"><a href="#section-3.9.3" class="auto internal xref">3.9.3</a>.  <a href="#name-segmented-schema-details" class="internal xref">Segmented Schema Details</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="auto internal xref">3.10</a>. <a href="#name-example-structures" class="internal xref">Example Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10.2.1">
                    <p id="section-toc.1-1.3.2.10.2.1.1"><a href="#section-3.10.1" class="auto internal xref">3.10.1</a>.  <a href="#name-leaf-only-data" class="internal xref">Leaf-only data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10.2.2">
                    <p id="section-toc.1-1.3.2.10.2.2.1"><a href="#section-3.10.2" class="auto internal xref">3.10.2</a>.  <a href="#name-linear-chain" class="internal xref">Linear (chain)</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-experimenting-with-flic" class="internal xref">Experimenting with FLIC</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-usage-examples" class="internal xref">Usage Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-locating-flic-leaf-and-mani" class="internal xref">Locating FLIC leaf and manifest nodes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-seeking" class="internal xref">Seeking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-block-level-de-duplication" class="internal xref">Block-level de-duplication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-growing-icn-collections" class="internal xref">Growing ICN collections</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-re-publishing-a-flic-under-" class="internal xref">Re-publishing a FLIC under a new name</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-integrity-and-origin-authen" class="internal xref">Integrity and Origin Authentication of FLIC Manifests</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-confidentiality-of-manifest" class="internal xref">Confidentiality of Manifest Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-privacy-of-names-and-linkab" class="internal xref">Privacy of names and linkability of access patterns</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-symmetric-key-lifespan-scop" class="internal xref">Symmetric key lifespan, scope, and use</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-building-trees" class="internal xref">Building Trees</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">ICN architectures, such as Content-Centric Networking (CCNx)<span>[<a href="#RFC8569" class="cite xref">RFC8569</a>]</span> and Named Data Networking <span>[<a href="#NDN" class="cite xref">NDN</a>]</span>, are
        well suited for static content distribution. Each piece of (possibly immutable) static
        content is assigned a name by its producer. Consumers fetch this content using said name.
        Optionally, consumers may specify the full name of content, which includes its name and a
        cryptographic digest of said content, so the reques is self-verifying.<a href="#section-1-1" class="pilcrow">¶</a></p>
<aside id="section-1-2">
        <p id="section-1-2.1">Note: The reader is assumed to be familiar with general ICN concepts from CCNx or NDN.
          For general ICN terms, this document uses the terminology defined in <span>[<a href="#RFC7927" class="cite xref">RFC7927</a>]</span>. Where more specificity is needed, we utilize <span><a href="#RFC8569" class="internal xref">CCNx</a> [<a href="#RFC8569" class="cite xref">RFC8569</a>]</span> terminology where a Content Object is the
          data structure that holds application payload.
          Terms defined specifically for FLIC are enumerated below in <a href="#Terminology" class="auto internal xref">Section 3.1</a>.<a href="#section-1-2.1" class="pilcrow">¶</a></p>
<p id="section-1-2.2">
          In this document, we prefer the CCNx terminology.  We will use the CCNx term
          Content Object, where NDN would use the term Data packet.  The term Content Objec Hash
          in CCNx corresponds to the NDN Implicit Digest.<a href="#section-1-2.2" class="pilcrow">¶</a></p>
</aside>
<p id="section-1-3">To enable requests with full names, consumers need a priori knowledge of content digests.
        A Manifest, a form of catalog, is a data structures commonly employed to store and transport
        this information. Typically, ICN manifests are signed content objects (data) which carry a
        collection of hash digests. As content objects, a manifest itself may be
        fetched by full name. A manifest may contain either hash digests of, or pointers to,
        either other manifests or content objects. A collection of manifests and content objects
        represents a large piece of application data, e.g., one that cannot otherwise fit in a
        single content object.  Because a manifest contains a collection of hashes, it is by
        definition non-circular because one cannot hash the manifest before filling it in.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Structurally, this relationship between manifests and content objects is reminiscent of the
        UNIX inode concept with index tables and memory pointers. In this document, we specify a
        simple, yet extensible, manifest data structure called FLIC - <em>File-Like ICN
          Collection</em>. FLIC is suitable for ICN protocol suites such as CCNx and NDN. We
        describe the FLIC design, grammar, and various use cases, e.g., ordered fetch, seeking,
        de-duplication, extension, and variable-sized encoding. We also include FLIC encoding
        examples for CCNx and NDN.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The purpose of a manifest is to concisely name, and hence point to, the constiuent pieces
        of a larger object. A FLIC manifest does this by using a <em>root</em> manifest to name and
        cryptographically sign the data structure and then use concise lists of hash-based names to
        indicate the constituent pieces. This maintains strong security from a single signature. A
        Manifest entry gives one enough information to create an <em>Interest</em> for that entry,
        so it must specify the name, the hash digest, and if needed, the locators.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">
        FLIC is a distributed data structure illustrated by the following picture.  The FLIC
        manifest is encoded in the Payload of a Content Object.  A <em>root manifest</em> has
        a name and a publisher signature.  Subsequent manifests, because they hare in a cryptographic
        hash tree using SHA256 pointers, do not need to be signed; they have implicit trust.
        In the figure we call out "data pointer" and "manifest pointer", but in the actual encoding
        they are all just hash values and the consumer does not necessarily know what it is fetching
        until it has fetched it.<a href="#section-1-6" class="pilcrow">¶</a></p>
<span id="name-simplified-flic-content-obj"></span><div id="example_manifest">
<figure id="figure-1">
        <div id="section-1-7.1">
          <div class="alignCenter art-svg artwork" id="section-1-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="80%" viewBox="0 0 672 272" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,16 L 8,256" fill="none" stroke="black"></path>
              <path d="M 24,80 L 24,224" fill="none" stroke="black"></path>
              <path d="M 288,80 L 288,136" fill="none" stroke="black"></path>
              <path d="M 288,184 L 288,224" fill="none" stroke="black"></path>
              <path d="M 304,16 L 304,136" fill="none" stroke="black"></path>
              <path d="M 304,184 L 304,256" fill="none" stroke="black"></path>
              <path d="M 344,128 L 344,160" fill="none" stroke="black"></path>
              <path d="M 368,176 L 368,224" fill="none" stroke="black"></path>
              <path d="M 528,128 L 528,160" fill="none" stroke="black"></path>
              <path d="M 8,16 L 88,16" fill="none" stroke="black"></path>
              <path d="M 224,16 L 304,16" fill="none" stroke="black"></path>
              <path d="M 24,80 L 104,80" fill="none" stroke="black"></path>
              <path d="M 176,80 L 288,80" fill="none" stroke="black"></path>
              <path d="M 344,128 L 528,128" fill="none" stroke="black"></path>
              <path d="M 240,144 L 328,144" fill="none" stroke="black"></path>
              <path d="M 344,160 L 528,160" fill="none" stroke="black"></path>
              <path d="M 272,176 L 320,176" fill="none" stroke="black"></path>
              <path d="M 368,176 L 384,176" fill="none" stroke="black"></path>
              <path d="M 624,176 L 640,176" fill="none" stroke="black"></path>
              <path d="M 328,192 L 352,192" fill="none" stroke="black"></path>
              <path d="M 624,192 L 664,192" fill="none" stroke="black"></path>
              <path d="M 624,208 L 664,208" fill="none" stroke="black"></path>
              <path d="M 24,224 L 288,224" fill="none" stroke="black"></path>
              <path d="M 368,224 L 640,224" fill="none" stroke="black"></path>
              <path d="M 8,256 L 304,256" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="672,208 660,202.4 660,213.6" fill="black" transform="rotate(0,664,208)"></polygon>
              <polygon class="arrowhead" points="672,192 660,186.4 660,197.6" fill="black" transform="rotate(0,664,192)"></polygon>
              <polygon class="arrowhead" points="360,192 348,186.4 348,197.6" fill="black" transform="rotate(0,352,192)"></polygon>
              <polygon class="arrowhead" points="336,144 324,138.4 324,149.6" fill="black" transform="rotate(0,328,144)"></polygon>
              <g class="text">
                <text x="156" y="20">Content Object</text>
                <text x="40" y="36">Name:</text>
                <text x="148" y="36">/icn/manifest/name</text>
                <text x="104" y="52">Payload Type: Maniest</text>
                <text x="52" y="68">Payload:</text>
                <text x="140" y="84">Manifest</text>
                <text x="96" y="100">HashGroup (HG):</text>
                <text x="108" y="116">optional metadata:</text>
                <text x="168" y="132">overall digest, locator, etc.</text>
                <text x="132" y="148">hash-valued data pointer</text>
                <text x="432" y="148">data Content Object</text>
                <text x="64" y="164">...</text>
                <text x="296" y="164">| |</text>
                <text x="148" y="180">hash-valued manifest pointer</text>
                <text x="504" y="180">sub manifest Content Object</text>
                <text x="156" y="212">optional additional HashGroups</text>
                <text x="92" y="244">optional signature</text>
              </g>
            </svg><a href="#section-1-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-simplified-flic-content-obj" class="selfRef">Simplified FLIC Content Object and acyclic graph example</a>
        </figcaption></figure>
</div>
<p id="section-1-8">A key design decision is how one names the root manifest, the application data, and
        subsidiary manifests. FLIC uses the concept of a Name Constructor. The root
        manifest (in fact, any FLIC manifest) may include a Name Constructor that instructs a
        manifest reader how to properly create Interests for the associated application data and
        subsidiary manifests. The Name Constructors allow interest construction using a well-known,
        application-independent set of rules. Some name constructor forms are tailored towards
        specific ICN protocols, such as CCNx or NDN; some are more general and could work with many
        protocols. We describe the allowed Name Constructor methods in <a href="#nameconstructors" class="auto internal xref">Section 3.3</a>. There are also particulars of how to encode
        the name schema in a given ICN protocol, which we describe in <a href="#encodings" class="auto internal xref">Section 3.9</a>.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">FLIC has encodings for <span><a href="#CCNxEncoding" class="internal xref">CCNx</a> (<a href="#CCNxEncoding" class="auto internal xref">Section 3.9.1</a>)</span> as per
          <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span> and for <span><a href="#NDNEncoding" class="internal xref">NDN</a> (<a href="#NDNEncoding" class="auto internal xref">Section 3.9.2</a>)</span>.  For the implementor, the section <a href="#CCNxTlvs" class="auto internal xref">Section 3.9.1.5</a> 
          succintly defines the CCNx TLV structures and the format of each TLV value.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">An example implementation in Python may be found at <span>[<a href="#FLICImplementation" class="cite xref">FLICImplementation</a>]</span>.<a href="#section-1-10" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-flic-as-an-icn-experimental">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-flic-as-an-icn-experimental" class="section-name selfRef">FLIC as an ICN experimental tool</a>
        </h3>
<p id="section-1.1-1">FLIC enables experimentation with how to structure and retrieve large data objects and
          collections in ICN. By having a common data structure applications can rely on, with a
          common library of code that can be used to create and parse manifest data structures,
          applications using ICN protocols can both avoid unnecessary reinvention and also have
          enhanced interoperability. Since the design attempts to balance simplicity, universality,
          and extensibility, there are a number of important experimental goals to achieve that may
          wind up in conflict with one another. We provide a partial list of these experimental
          issues in <a href="#experiments" class="auto internal xref">Section 4</a>. It is also important for users of FLIC to
          understand that some flexibility and extensions might be removed if use cases do not
          materialize to justify their inclusion in an eventual standard.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-requirements-language">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
          NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
          described in <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="overview">
<section id="section-2">
      <h2 id="name-design-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-design-overview" class="section-name selfRef">Design Overview</a>
      </h2>
<p id="section-2-1">The FLIC design adopts the proven UNIX inode concept of direct and indirect pointers, but
        without the specific structural forms of direct versus indirect. FLIC is a collection of
        pointers, and when one de-references the pointer it could be an application object or
        another FLIC manifest.
        The pointers in FLIC use
        hash-based naming of Content Objects analogous to the function block numbers play in UNIX
        inodes.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2"> Because FLIC uses hash-based pointers as names, FLIC graphs are inherently acyclic. Both
        CCNx and NDN support hash-based naming, though the details differ (see <a href="#CCNxEncoding" class="auto internal xref">Section 3.9.1</a> and <a href="#NDNEncoding" class="auto internal xref">Section 3.9.2</a>).<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The FLIC datastructure is an acyclic digraph of Content Objects.  In this document, our
        examples are trees, but that is not a requirement.  For example, a de-duplication
        representation might have a common object with many 0s and that object could be
        references from multiple places in the tree.  As another example, there could be
        a common sub-collection of objects organized in a Manifest, and that sub-manifest
        could be included in multiple places.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">In FLIC terms, a direct pointer links to application-level data, which is a Content Object
        with application data in the Payload. An indirect pointer links to a Content Object with a
        FLIC Manifest in the Payload.<a href="#section-2-4" class="pilcrow">¶</a></p>
<aside id="section-2-5">
        <p id="section-2-5.1">Note: A substantial advantage of using hash-based naming is that it permits block-level
          de-duplication of application data because two blocks with the same payload will have the
          same hash name.<a href="#section-2-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-2-6">The FLIC structure that is expected most applications would use consists of a root
        manifest with a strong cryptographic signature and then cryptographically strong (e.g.
        SHA256 <span>[<a href="#SHS" class="cite xref">SHS</a>]</span>) hash names as pointers to other manifests. The advantage of
        this structure is that the single signature in the root manifest covers the entire data
        structure no matter how many additional manifests are in the data structure. Another
        advantage of this structure is it removes the need to use chunk (CCNx) or segment (NDN) name
        components for the subordinate manifests.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">Another usage is to have a signed Root Manifest with a single pointer to the Top Manifest.
      The Top Manifest maybe a CCNx Nameless object.  This method allows an intermediary service to respond
      to client requests with its own signed Manifest that then points to a small Root manifest.
      The client trusts the intermediary's reponse because of the intermediary's signature, and then
      trusts the content because of the Root manifest.  In some cases, the intermediary could
      embed the Root Manifest (because it is small) and avoid additional round trips before
      beginning download.  This technique is used in a
        <span><a href="#ProjectOrigin" class="internal xref">peer-to-peer sharing protocol</a> [<a href="#ProjectOrigin" class="cite xref">ProjectOrigin</a>]</span>.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">FLIC supports manifest encryption separate from application payload encryption (See <a href="#encryption" class="auto internal xref">Section 3.8</a>). It has a flexible encryption envelope to support various
        encryption algorithms and key discovery mechanisms. The byte layout allows for in-place
        encryption and decryption.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">A limitation of this approach is that one cannot construct a hash-based name for a child
        until one knows the payload of that child. In practical terms, this means that one must have
        the complete application payload available at the time of manifest creation.<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">FLIC's design allows straightforward applications that just need to traverse a linear set
        of related objects to do so simply, but FLIC has two extensibility mechanisms that allow for
        more sophisticated uses: manifest metadata, and pointer annotations. These are described in
          <a href="#metadata" class="auto internal xref">Section 3.4</a> and <a href="#annotations" class="auto internal xref">Section 3.5</a>
        respectively.<a href="#section-2-10" class="pilcrow">¶</a></p>
<div id="libraries">
<p id="section-2-11">FLIC goes to considerable lengths to allow creation and parsing by
        application-independent library code. Therefore, any options used by applications in the
        data structure or encryption capabilities MUST NOT require applications to have
        application-specific Manifest traversal algorithms. This ensures that such application
        agnostic libraries can always successfully parse and traverse any FLIC Manifest by ignoring
        the optional capabilities.<a href="#section-2-11" class="pilcrow">¶</a></p>
</div>
<p id="section-2-12">The reader may find it useful to refer to Section <span><a href="#Usage" class="internal xref">Example Usages</a> (<a href="#Usage" class="auto internal xref">Section 5</a>)</span>
      from time to time to see worked out examples.<a href="#section-2-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="structure">
<section id="section-3">
      <h2 id="name-flic-structure">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-flic-structure" class="section-name selfRef">FLIC Structure</a>
      </h2>
<div id="Terminology">
<section id="section-3.1">
        <h3 id="name-terminology">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.1-1">
          <dt id="section-3.1-1.1">Data Object:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.2">a CCNx nameless Content Object that usually only has Payload. It might also have an
            ExpiryTime to limit the lifetime of the data.<a href="#section-3.1-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.3">Direct Pointer:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.4">borrowed from inode terminology, it is a CCNx link using a content object hash
            restriction and a locator name to point to a Data Object.<a href="#section-3.1-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.5">Hash Group:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.6">KA collection of pointers.  A Manifest should have atleast one Hash Group.
          A Hash Group may have its own associated meta data and Name Constructor.<a href="#section-3.1-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.7">Indirect Pointer:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.8">borrowed from inode terminology, it is a CCNx link using a content object hash
            restriction and a locator name to point to a manifest content object.<a href="#section-3.1-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.9">Internal Manifest:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.10">some or all pointers are indirect. The order and number of each is up to the manifest
            builder. By convention, all the direct manifests come first, then the indirect.<a href="#section-3.1-1.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.11">Leaf Manifest:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.12">all pointers are direct pointers.<a href="#section-3.1-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.13">Locator:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.14">A routing hint in an Interest used by forwarding to get the Interest to where it can
            be matched based on its Name Constructor-derived name.<a href="#section-3.1-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.15">Manifest:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.16">a CCNx ContentObject with PayloadType 'Manifest' and a Payload of the encoded
            manifest. A leaf manifest only has direct pointers. An internal manifest has a mixture
            of direct and indirect pointers.  The outer TLV type of the payload identifies
            the manifest specifically as a FLIC manifest.<a href="#section-3.1-1.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.17">Manifest Waste:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.18">a metric used to measure the amount of waste in a manifest tree. Waste is the number
            of unused pointers. For example, a leaf manifest might be able to hold 40 direct
            pointers, but only 30 of them are used, so the waste of this node is 10. Manifest tree
            waste is the sum of waste over all manifests in a tree.<a href="#section-3.1-1.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.19">Name Constructor:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.20">The specification of how to construct an Interest for a Manifest entry.<a href="#section-3.1-1.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.21">Node</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.22">The <code>Node</code> section of a manifest holds the manifest information.  It has
          node-wide metadata in a <code>NodeData</code> section, and then a series of <code>HashGroups</code>.<a href="#section-3.1-1.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.23">EncryptedNode</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.24">A <code>Node</code> that is encrypted as specified in the Manifest's <code>SecurityCtx</code>.
          It is opaque octetes.<a href="#section-3.1-1.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.25">Root Manifest:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.26">A signed, named, manifest that points to nameless manifest nodes. This structure means
            that the internal tree structure of internal and leaf manifests have no names and thus
            may be located anywhere in a namespace, while the root manifest has a name to fetch it
            by.<a href="#section-3.1-1.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.27">Top Manifest:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-1.28">One useful manifest structure is to use a Root manifest that points to a single
            Internal manifest called the Top Manifest. The Top manifest the begins the structure
            used to organize manifests. It is also possible to elide the two and use only a root
            manifest that also serves in the role of the top manifest.<a href="#section-3.1-1.28" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="locators">
<section id="section-3.2">
        <h3 id="name-locators">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-locators" class="section-name selfRef">Locators</a>
        </h3>
<p id="section-3.2-1">Locators are routing hints used by forwarders to get an Interest to a node in the network
          that can resolve the Interest's name. In some naming conventions, the name might only be a
          hash-based name so the Locator is the only available routing information. Locators exist
          in both CCNx and NDN, though the specific protocol mechanisms differ. A FLIC manifest
          represents locators in the same way for both ICN protocols inside <span><a href="#nameconstructors" class="internal xref">Name Constructors</a> (<a href="#nameconstructors" class="auto internal xref">Section 3.3</a>)</span>, though they are encoded
          differently in the underlying protocol. See <a href="#encodings" class="auto internal xref">Section 3.9</a>
          for encoding differences.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">CCNx only uses locators with nameless objects, whereas NDN may use multiple ForwardingHints
            per interest.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">A name constructor definition may define one or more Locator prefixes that can be used in the
          construction of Interests from the pointers in the manifest. The Locators are inherited
          when walking a manifest tree, so they do not need to be defined everywhere. It is
          RECOMMENDED that only the Root manifest contain Locators so that a single operation can
          update the locators. One use case when storing application payloads at different replicas
          is to replace the Root manifest with a new one that contains locators for the current
          replicas.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nameconstructors">
<section id="section-3.3">
        <h3 id="name-name-constructors">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-name-constructors" class="section-name selfRef">Name Constructors</a>
        </h3>
<p id="section-3.3-1">A Manifest may define zero or more name constructors in NameConstructorDefinitions (NCD)
          located in the Manifest Node. An NCD associates a Name Constructor Id (NCID) to a Name
          Constructor. The NCID is used in other parts of the Manifest to refer to that specific
          definition.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">A manifest organizes pointers inside Hash Groups.  Each Hash Group uses an NCID to
        indicate what Name Constructor to use to fetch the pointers inside the group.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">NCID 0 is the default name constructor. If it is not defined in an NCD, it is assumed to
          be a HashNamingConstructor. A Manifest may re-define the default as needed.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">A Manifest MUST use locally unique NCIDs in the NCD.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">NCDs and their associated NCIDs are inherited as one traverses a manifest. That is, a
          manifest consumer must remember the NCDs as it traverses manifests. If it encounters a
          HashGroup that uses an unknown NCID, the RECOMMENDED action is to report a malformed
          manifest to the user.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">A Manifest may update an NCID. If a child manifest re-defines an NCID, the manifest
          consumer MUST use the new definition from that point forward under that Manifest
          branch.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">It is RECOMMENDED that only the root or similar top-level manifest define NCDs and they
          not be re-defined in subsequent manifests.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">We expect that an application constructing a Manifest will take one of three approaches
          to name constructors. The advantage of using, or re-defining, the default name constructor
          is that any hash groups that use it do not need to specify an NCID and thus might save
          some space.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-9.1">A manifest might define (or use) a default name constructor and mix subsequent
            Manifest and Data objects under that same namespace. The manifest only needs to use one
            Hash Group and can freely mix Manifest and Data pointers.<a href="#section-3.3-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-9.2">
            <p id="section-3.3-9.2.1">A manifest might define (or use) a default name constructor for subsequent Manifests
              and define a second NCD for the application data. This places all subsequent manifests
              under the default constructor and places all application data under the second NCD.
              The Manifest must use at least two Hash Groups.<a href="#section-3.3-9.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3-9.2.2">There are a few options on how to organize the Hash Groups:<a href="#section-3.3-9.2.2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.3-9.2.3">
              <dt>(1)</dt>
<dd id="section-3.3-9.2.3.1">Manifest Hash Group followed by Data Hash group,<a href="#section-3.3-9.2.3.1" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(2)</dt>
<dd id="section-3.3-9.2.3.2">Data Hash Group followed by Manifest Hash Group,<a href="#section-3.3-9.2.3.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(3)</dt>
<dd id="section-3.3-9.2.3.3">Intermix multiple manifest and data hash groups for interleaved reading, or<a href="#section-3.3-9.2.3.3" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(4)</dt>
<dd id="section-3.3-9.2.3.4">use a data-on-leaf only approach: the interior manifests would use the manifest
                hash group and the leaves would use the data hash group. Other organizations are
                possible.<a href="#section-3.3-9.2.3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
          <li class="normal" id="section-3.3-9.3">Define multiple NCDs for subsequent manifests and data, or not use the default NCD, or
            use some other organization.<a href="#section-3.3-9.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-10">In this specification, we define the following four types of Name Constructors.
          Additional name constructor types may be specified in a subsequent revision of the
          specification. Here, we informally define the name constructors. <a href="#grammar" class="auto internal xref">Section 3.6</a>
          specifies the encoding of each name constructor.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-11">
          <dt id="section-3.3-11.1">Type 0 (Interest-Derived Naming):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-11.2">Use whatever name was used in the Interest to retrieve this Manifest, less a hash
            component, and append the desired hash value.<a href="#section-3.3-11.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-11.3">Type 1 (Data-Derived Naming):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-11.4">Use the Manifest Name, less a hash component, as the Interest name, and append the
            desired hash value.<a href="#section-3.3-11.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-11.5">Type 2 (Prefix List):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-11.6">The NCD specifies a <code>name</code>, which will appear in every content object for
          that name constructor.  The comsumer uses it in an interest with the appropriate
          hash.  The NCD may specify locators, which NDN uses as ForwardingHints.  They are not
          used by CCNx, as these are not nameless objects.<a href="#section-3.3-11.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-11.7">Type 3 (Segmented Naming):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-11.8">As in Type 2, but the consumer MUST track Segment Numbers.  If the Hash Group provides
          Segment Number annotations for each pointer, it MUST use those numbers.  Otherwise, the
          consumer MUST use a 0-based counter that follows the traversal order.  The publisher
          MAY include a <code>StartSegmentId</code> field in the group data to indicate the index
          of the first hash pointer of the group.<a href="#section-3.3-11.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-12">In Type 0, the consumer uses some name N to fetch a manifest.  When the consumer receives
        the Manifest back, it begins issuing interests for the content using the same name N, but with
        the hash pointers from the manifest.<a href="#section-3.3-12" class="pilcrow">¶</a></p>
<p id="section-3.3-13">In Type 1, the consumer uses some name N to fetch a manifest.  The consumer receives a
        manifest back with name M inside the Manifest Content Object.  The consumer then uses the
        name M plus hash pointers from the manifest.<a href="#section-3.3-13" class="pilcrow">¶</a></p>
<p id="section-3.3-14">In Type 2, the consumer receives a manifest and begins traversing it.  If it visits a
          Hash Group with a PrefixSchema Name Constructor, then that Name Constructor provides the name
          to use, plus optional NDN forwarding hints.<a href="#section-3.3-14" class="pilcrow">¶</a></p>
<p id="section-3.3-15">In Type 3, if a Hash Group has a SegmentedSchema Name Constructor, then
          the consumer uses the same mechanism as Type 2, but with the addition
        of a Segment Number in the name.  Segmented naming is only compatible with deterministic
        traversal orders or if the Manifest provides Segment Number annotations or a StartSegmentId.<a href="#section-3.3-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata">
<section id="section-3.4">
        <h3 id="name-manifest-metadata">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-manifest-metadata" class="section-name selfRef">Manifest Metadata</a>
        </h3>
<p id="section-3.4-1">The FLIC Manifest may be extended by defining TLVs that apply to the Manifest as a whole,
          or alternatively, individually to every data object pointed to by the Manifest. This basic
          specification does not specify any, but metadata TLVs may be defined through additional
          RFCs or via Vendor TLVs. FLIC uses a Vendor TLV structure identical to <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span> for vendor-specific annotations that require no
          standardization process.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">For example, some applications may find it useful to allow specialized consumers such as
            <em>repositories</em> (for example <span>[<a href="#repository" class="cite xref">repository</a>]</span>) or enhanced forwarder
          caches to pre-place, or adaptively pre-fetch data in order to improve robustness and/or
          retrieval latency. Metadata can supply hints to such entities about what subset of the
          compound object to fetch and in what order.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<aside id="section-3.4-3">
          <p id="section-3.4-3.1">Note: FLICs ability to use separate namespaces for the Manifest and the underlying Data
            allows different encryption keys to be used, hence giving a network element like a cache
            or repository access to the Manifest data does not as a side effect reveal the contents
            of the application data itself.<a href="#section-3.4-3.1" class="pilcrow">¶</a></p>
</aside>
</section>
</div>
<div id="annotations">
<section id="section-3.5">
        <h3 id="name-pointer-annotations">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-pointer-annotations" class="section-name selfRef">Pointer Annotations</a>
        </h3>
<p id="section-3.5-1">FLIC allows each manifest pointer to be annotated with extra data. Annotations allow
          applications to exploit metadata about each Data Object pointed to without having to first
          fetch the corresponding Content Object. This specification defines three annotations:
          <code>SizeAnnotation</code>, <code>SegmentIdAnnotation</code>, and <code>LinkAnnotation</code>.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">The <em>SizeAnnotation</em> specifies the number of application layer octets covered by
          the pointer.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">The <em>SegmentIdAnnotation</em> is a unique suffix for the pointer for use with
          the Seegmented Schema name constructor.  Use annotations allows non-sequential segment IDs, which
          could happen if manifest trees are named in the traversal order.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">The <em>LinkAnnotation</em> is a link to be used to name the pointer (less the pointer itself).
          For NDN, the poitner would be appended to the name for a complete name.  In CCNx, the name would
          be used in the Interest along with the pointer in the ContentObjectHashRestriction field.  The
          link may include a KeyId restriction.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<aside id="section-3.5-5">
          <p id="section-3.5-5.1">One may include a KeyId restriction in the generated interest by also using the
            <code>ProtocolFlags</code> option of a name constructor.  This would be much more space efficient
            than using annotated pointers.<a href="#section-3.5-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-3.5-6">Other annotation may, for example, give hints about a desirable traversal order for fetching
          the data, or an importance/precedence indication to aid applications that do not require
          every content object pointed to in the manifest to be fetched. This can be very useful for
          real-time or streaming media applications that can perform error concealment when
          rendering the media.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">Additional annotations may be defined through additional specifications or via Vendor TLVs.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="grammar">
<section id="section-3.6">
        <h3 id="name-manifest-grammar-abnf">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-manifest-grammar-abnf" class="section-name selfRef">Manifest Grammar (ABNF)</a>
        </h3>
<p id="section-3.6-1">The manifest grammar is mostly, but not entirely independent of the ICN protocol used to
          encode and transport it. The TLV encoding therefore follows the corresponding ICN
          protocol, so for CCNx FLIC uses 2 octet length, 2 octet type and for NDN uses the 1/3/5
          octet types and lengths (see <span>[<a href="#NDNTLV" class="cite xref">NDNTLV</a>]</span> for details). There are also some
          differences in how one structures and resolves links. <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span> defines HashValue and Link for CCNx encodings. The NDN
          ImplicitSha256DigestComponent defines HashValue and NDN Delegation (from Link Object)
          defines Link for NDN. <a href="#encodings" class="auto internal xref">Section 3.9</a> below specifies these differences.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">The basic structure of a FLIC manifest comprises a security context, a node, and an
          authentication tag. The security context and authentication tag are not needed if the node
          is unencrypted. A node is made up of a set of metadata, the <code>NodeData</code>, that
          applies to the entire node, and one or more <code>HashGroups</code> that contain pointers.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">The <code>NodeData</code> element defines the namespaces used by the manifest. There may be
          multiple namespaces, depending on how one names subsequent manifests or data objects. Each
            <code>HashGroup</code> may reference a single namespace to control how one forms Interests
          from the <code>HashGroup</code>. If one is using separate namespaces for manifests and
          application data, one needs at least two hash groups. For a manifest structure of
          "MMMDDD," (where M means manifest (indirect pointer) and D means data (direct pointer))
          for example, one would have a first <code>HashGroup</code> for the child manifests with its
          namespace and a second <code>HashGroup</code> for the data pointers with the other namespace.
          If one used a structure like "MMMDDDMMM," then one would need three hash groups.<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<span id="name-flic-grammar"></span><div id="flicgrammar">
<figure id="figure-2">
          <div class="breakable lang-abnf sourcecode" id="section-3.6-4.1">
<pre>
TYPE = 2OCTET / {1,3,5}OCTET ; As per CCNx or NDN TLV
LENGTH = 2OCTET / {1,3,5}OCTET ; As per CCNx or NDN TLV

Manifest = T_FLIC_MANIFEST LENGTH [SecurityCtx] (EncryptedNode / Node) [AuthTag]

SecurityCtx = T_SECURITY_CTX LENGTH AlgorithmCtx
AlgorithmCtx = AEADCtx / RsaWrapCtx
AuthTag = T_AUTH_TAG LENGTH *OCTET ; e.g. AEAD authentication tag
EncryptedNode = T_ENCRYPTED_NODE LENGTH *OCTET ; Encrypted Node

Node = T_NODE LENGTH [NodeData] 1*HashGroup
NodeData = T_NODE_DATA LENGTH [SubtreeSize] [SubtreeDigest] [Locators]
           0*Vendor 0*NcDef
SubtreeSize = T_SUBTREE_SIZE LENGTH INTEGER
SubtreeDigest = T_SUBTREE_DIGEST LENGTH HashValue

NcDef = T_NCDEF LENGTH NcId NcSchema
NcId = T_NCID LENGTH INTEGER
NcSchema = InterestDerivedSchema / DataDerivedSchema /
           PrefixSchema / SegmentedSchema / HashSchema

InterestDerivedSchema = TYPE LENGTH [ProtocolFlags]
DataDerivedSchema = TYPE LENGTH [ProtocolFlags]

PrefixSchema = T_PrefixSchema LENGTH Name [Locators] [ProtocolFlags]
SegmentedSchema = T_SegmentedSchema LENGTH Name SuffixComponentType [Locators] [ProtocolFlags]
SuffixComponentType = T_SUFFIX_TYPE LENGTH 1*OCTET
HashSchema = T_HashSchema LENGTH Locators [ProtocolFlags]

Locators = T_LOCATORS LENGTH 1*Locator
HashValue = TYPE LENGTH *OCTET ; As per ICN Protocol
Locator = TYPE LENGTH Link ; Link As per ICN protocol

ProtocolFlags = T_PROTOCOL_FLAGS LENGTH *OCTET
                ; ICN-specific flags, e.g. must be fresh

HashGroup = T_HASH_GROUP LENGTH [GroupData] (Ptrs / AnnotatedPtrs)
Ptrs = T_PTRS LENGTH *HashValue
AnnotatedPtrs = T_ANNOTATED_PTRS LENGTH *PointerBlock
PointerBlock = T_PTR_BLOCK LENGTH *Annotation Ptr
Ptr = T_PTR LENGTH HashValue

Annotation = SizeAnnotation / SegmentIdAnnotation /
             LinkAnnotation / Vendor
SizeAnnotation = T_ANN_SIZE LENGTH Integer
SegmentIdAnnotation = T_ANN_SEGMENT_ID LENGTH Integer
LinkAnnotation = T_LINK LENGTH Link
Vendor = T_ORG LENGTH PEN *OCTET
PEN = 3OCTET ; IANA Private Enterprise Number

GroupData = TYPE LENGTH [NcId] [LeafSize] [LeafDigest]
            [SubtreeSize] [SubtreeDigest] [StartSegmentId]
            0*Vendor
LeafSize = T_LEAF_SIZE LENGTH INTEGER
LeafDigest = T_LEAF_DIGEST LENGTH HashValue
StartSegmentId = T_START_SEGMENT_ID LENGTH Integer

AEADCtx = T_AEAD_CTX LENGTH AEADData
AEADData = KeyNum AEADNonce AEADMode [KDFData]
KeyNum = T_KEYNUM LENGTH INTEGER
AEADNonce = T_NONCE LENGTH 1*OCTET
AEADMode = T_AEADMode LENGTH (AEAD_AES_128_GCM / AEAD_AES_256_GCM /
           AEAD_AES_128_CCM / AEAD_AES_128_CCM)
           ; RFC5116 definitions
KDFData = T_KDF_DATA LENGTH KDFAlg [KDFInfo]
KDFAlg = T_KDF_ALG LENGTH INTEGER
    ; IANA "HPKE KDF Identifiers" [RFC9180]
KDFInfo = T_KDF_INFO LENGTH 1*OCTET
    ; Passed to the KDF Info

RsaOaepCtx = T_RSAOAEP_CTX LENGTH RsaOaepData
RsaOaepData = AEADData [RsaOaepWrapper]
RsaOaepWrapper = KeyId [KeyLink] HashAlg WrappedKey
    ; KeyId as pre RFC8609 for CCNx
    ; KeyLink as pre RFC8609 for CCNx
HashAlg = T_HASH_ALG LENGTH alg_number
    ; alg_number from IANA "CCNx Hash Function Types"
WrappedKey = T_WRAPPED_KEY LENGTH RsaOaepEnc{4OCTET 1*OCTET}
    ; Encrypted 4-byte salt plus AES key

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-flic-grammar" class="selfRef">FLIC Grammar</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.6-5">
          <dt id="section-3.6-5.1">SecurityCtx:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.2">information about how to decrypt an <code>EncryptedNode</code>. The structure will depend on the specific encryption algorithm.<a href="#section-3.6-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.3">AEADMode</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.4">"AEAD Algorithms" values from IANA "Authenticated Encryption with Associated Data (AEAD) Parameters."
            FLIC only specifies the use of four basic algorithms with full authentication tag.<a href="#section-3.6-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.5">AlgorithmId:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.6">The ID of the encryption method (e.g. preshared key, a broadcast encryption scheme, etc.)<a href="#section-3.6-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.7">AlgorithmData:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.8">The context for the encryption algorithm.<a href="#section-3.6-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.9">EncryptedNode:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.10">An opaque octet string with an optional authentication tag (i.e. for AEAD authentication tag)<a href="#section-3.6-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.11">Node:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.12">A plain-text manifest node. The structure allows for in-place encryption/decryption.<a href="#section-3.6-5.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.13">NodeData:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.14">the metadata about the Manifest node<a href="#section-3.6-5.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.15">SubtreeSize:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.16">The size of all application data at and below the Node or Group<a href="#section-3.6-5.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.17">SubtreeDigest:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.18">The cryptographic digest of all application data at and below the Node or Group<a href="#section-3.6-5.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.19">Locators:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.20">An array of routing hints to find the manifest components<a href="#section-3.6-5.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.21">HashGroup:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.22">A set of child pointers and associated metadata<a href="#section-3.6-5.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.23">Ptrs:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.24">A list of one or more Hash Values<a href="#section-3.6-5.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.25">GroupData:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.26">Metadata that applies to a HashGroup<a href="#section-3.6-5.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.27">LeafSize:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.28">Size of all application data immediately under the Group (i.e. via direct pointers)<a href="#section-3.6-5.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.29">LeafDigest:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.30">Digest of all application data immediately under the Group<a href="#section-3.6-5.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.31">StartSegmentId:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.32">
            If using a name constructor that requires a chunk number (segment number), this field indicates the starting value
            for the group.  Using the StartSegmentId means that a consumer does not need to track the segment id between
            manifests and simplifies interest name generation.<a href="#section-3.6-5.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-5.33">Ptr:</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-5.34">The ContentObjectHash of a child, which may be a data ContentObject (i.e. with Payload) or another Manifest Node.<a href="#section-3.6-5.34" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="trees">
<section id="section-3.7">
        <h3 id="name-manifest-trees">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-manifest-trees" class="section-name selfRef">Manifest Trees</a>
        </h3>
<div id="traversal">
<section id="section-3.7.1">
          <h4 id="name-traversal">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-traversal" class="section-name selfRef">Traversal</a>
          </h4>
<p id="section-3.7.1-1">FLIC manifests use a pre-order traversal. This means they are read top to bottom, left
            to right. The algorithms in <a href="#pseudocode" class="auto internal xref">Figure 3</a> show the pre-order forward
            traversal code and the reverse-order traversal code, which we use below to construct
            such a tree. This document does not mandate how to build trees. <a href="#building-trees" class="auto internal xref">Appendix A</a> provides a detailed example of building inode-like
            trees.<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">If using Annotated Pointers, an annotation could influence the traversal order.<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
<span id="name-traversal-pseudocode"></span><div id="pseudocode">
<figure id="figure-3">
            <div class="lang-c sourcecode" id="section-3.7.1-3.1">
<pre>
 preorder(node)
    if (node = null)
       return
    visit(node)
    for (i = 0, i &amp;lt; node.child.length, i++)
       preorder(node.child[i])

reverse_preorder(node)
   if (node = null)
       return
   for (i = node.child.length - 1, i &amp;gt;= 0, i-- )
       reverse_preorder(node.child[i]) visit(node)
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-traversal-pseudocode" class="selfRef">Traversal Pseudocode</a>
            </figcaption></figure>
</div>
<p id="section-3.7.1-4">In terms of the FLIC grammar, one expands a node into its hash groups, visiting each
            hash group in order. In each hash group, one follows each pointer in order. <a href="#expansion" class="auto internal xref">Figure 4</a> shows how hash groups inside a manifest expand like virtual
            children in the tree. The in-order traversal is M0, HG1, M1, HG3, D0, D1, D2, HG2, D3,
            D4.<a href="#section-3.7.1-4" class="pilcrow">¶</a></p>
<span id="name-node-expansio"></span><div id="expansion">
<figure id="figure-4">
            <div id="section-3.7.1-5.1">
              <div class="alignCenter art-svg artwork" id="section-3.7.1-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="20%" viewBox="0 0 112 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 60,24 L 64,32" fill="none" stroke="black"></path>
                  <path d="M 28,24 L 60,24" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="12" y="20">M0</text>
                    <text x="8" y="36">|</text>
                    <text x="16" y="52">HG1</text>
                    <text x="72" y="52">HG2</text>
                    <text x="16" y="68">| \</text>
                    <text x="64" y="68">|</text>
                    <text x="88" y="68">\</text>
                    <text x="24" y="84">M1 D2</text>
                    <text x="68" y="84">D3</text>
                    <text x="100" y="84">D4</text>
                    <text x="8" y="100">|</text>
                    <text x="16" y="116">HG3</text>
                    <text x="8" y="132">|</text>
                    <text x="32" y="132">\</text>
                    <text x="24" y="148">D0 D1</text>
                  </g>
                </svg><a href="#section-3.7.1-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-node-expansio" class="selfRef">Node Expansio</a>
            </figcaption></figure>
</div>
<p id="section-3.7.1-6">Using the example manifest tree shown in <a href="#leafonly" class="auto internal xref">Figure 23</a>, the in-order
            traversal would be: Root, M0, M1, D0, D1, D2, M2, D3, D4, D5, M3, D6, D7, D8.<a href="#section-3.7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="encryption">
<section id="section-3.8">
        <h3 id="name-manifest-encryption-modes">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-manifest-encryption-modes" class="section-name selfRef">Manifest Encryption Modes</a>
        </h3>
<p id="section-3.8-1">This document specifies two encryption modes. The first is a preshared key mode, where
          the parties are assumed to have the decryption keys already. It uses AES-GCM or AES-CCM.
          This is useful, for example, when using a key agreement protocol such as <span><a href="#I-D.wood-icnrg-ccnxkeyexchange" class="internal xref">CCNxKE</a> [<a href="#I-D.wood-icnrg-ccnxkeyexchange" class="cite xref">I-D.wood-icnrg-ccnxkeyexchange</a>]</span>. 
            The second is an RSA key
          wrapping mode using RSA-OAEP, similar to <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>. This may be used for group
          keying.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">Additional modes may be defined in subsequent specifications. We expect that an RSA-KEM 
          mode and Elliptic Curve mode should be specified.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">For group key based encryption, FLIC uses RSA-OAEP to wrap the <code>WrappedKey</code> element. 
          This specification only details the
          pertinent aspects of the encryption. It describes how a consumer locates the appropriate
          keys in the ICN namespace. It does not specify aspects of a key manager which may or may
          not be used as part of key distribution and management, nor does it specify the protocol
          between a key manager and a publisher. In its simpliest form, the publisher could be the
          key manager, in which case there is no extra protocol needed between the publisher and key
          manager.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<p id="section-3.8-4">The manifest is always encrypted with an AEAD algorithm.  The difference between the
          preshared key mode and the RSA wrapped mode is how the parties communicate the AES 
          decryption key.  The group key mechanism facilitates the
          distribution of the shared key without an on-line key agreement protocol like (the expired
          draft) <span><a href="#I-D.wood-icnrg-ccnxkeyexchange" class="internal xref">CCNxKE</a> [<a href="#I-D.wood-icnrg-ccnxkeyexchange" class="cite xref">I-D.wood-icnrg-ccnxkeyexchange</a>]</span>.<a href="#section-3.8-4" class="pilcrow">¶</a></p>
<div id="aead">
<section id="section-3.8.1">
          <h4 id="name-aead-mode">
<a href="#section-3.8.1" class="section-number selfRef">3.8.1. </a><a href="#name-aead-mode" class="section-name selfRef">AEAD Mode</a>
          </h4>
<p id="section-3.8.1-1">This mechanism uses <span><a href="#AESGCM" class="internal xref">AES-GEM</a> [<a href="#AESGCM" class="cite xref">AESGCM</a>]</span> or <span><a href="#RFC3310" class="internal xref">AES-CCM</a> [<a href="#RFC3310" class="cite xref">RFC3310</a>]</span> for manifest encryption. A publisher creating a <code>SecurityCtx</code>
            SHOULD use the mechanisms in <span>[<a href="#RFC6655" class="cite xref">RFC6655</a>]</span> for AES-CCM IV generation and
            <span>[<a href="#RFC5288" class="cite xref">RFC5288</a>]</span>
            for AES-GCM IV generation.<a href="#section-3.8.1-1" class="pilcrow">¶</a></p>
<p id="section-3.8.1-2">When the publisher and consumer establish the <code>KeyNum</code>, they SHOULD also establish a salt.
            This results in a 4-byte salt and 8-byte nonce.  If no salt exists, the AEADNonce
            may be the entire IV.<a href="#section-3.8.1-2" class="pilcrow">¶</a></p>
<p id="section-3.8.1-3">The scope of the <code>KeyNum</code> is upto the publisher and consumer agreement.  It may be
          for a specific manifest, or a specific session (e.g. a CCNxKE session), or some longer period.
          FLIC does not specify how the publisher and consumer agree on shared keys, their lifespan,
          or scope.  See the <a href="#Security" class="auto internal xref">Section 7</a> section for a discussion.<a href="#section-3.8.1-3" class="pilcrow">¶</a></p>
<p id="section-3.8.1-4">As these references specify, it is essential that the publisher creating a Manifest
            never use a Nonce more than once for the same key. For keys exchanged via a session
            protocol, such as CCNx, the publisher MUST use unique nonces on each Manifest for that
            session. If the key is derived via a group key mechanism, the publisher MUST ensure that
            the same Nonce is not used more than once for the same Content Encryption Key.<a href="#section-3.8.1-4" class="pilcrow">¶</a></p>
<p id="section-3.8.1-5">The AEAD Mode uses <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span> defined symbols AEAD_AES_128_CCM,
            AEAD_AES_128_GCM, AEAD_AES_256_CCM and AEAH_AES_256_GCM to specify the key length and
            algorithm.<a href="#section-3.8.1-5" class="pilcrow">¶</a></p>
<p id="section-3.8.1-6"> The <code>KeyNum</code> identifies a key on the receiver. The key MUST be exactly of the
            length specific by the Mode. Many receivers may have the same key with the same
              <code>KeyNum</code>.<a href="#section-3.8.1-6" class="pilcrow">¶</a></p>
<p id="section-3.8.1-7">The publisher MAY use a KDF for the manifest.  If <code>KDFData</code> is present,
          the consumer MUST derive a manifest-specific key from the shared key identified by
          <code>KeyNum</code>.  The <code>KDFAlg</code> is taken from the IANA registry for <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.
          If <code>KDFInfo</code> is present, the consumer uses that string
          as in the KDF's <code>info</code> parameter.  If the <code>KDFInfo</code> is not present, then
          the consumer must use the <code>Name</code> TLV of the enclosing Content Object.  This option is
          only possible for <code>Segmented Schema</code> name constructors, where each maniest
          has a unique name.  If the publisher and consumer have agreed on a salt to be
          associated with the key for use in the AEAD algorithm, this salt should not be used
          in the KDF.  The publisher and consumer may agree on a seaparte random salt as
          part of their key agreement on the <code>KeyNum</code> for use in the KDF.<a href="#section-3.8.1-7" class="pilcrow">¶</a></p>
<p id="section-3.8.1-8">Within a single manifest tree, a publisher MAY use the same <code>KDFData</code>
          and <code>KDFInfo</code> over multiple manifests, so long as it uses unique <code>Nonce</code>.
          This allows a consumer to cache a single derived key based on the <code>(KeyNum, KDFInfo)</code>
          pair.  This is the normal use of the KDF mode: the publisher only needs to track a single
          unique value for each manifest using <code>KeyNum</code>, not all the individual Nonces used
          with in a manifest tree.  If the publisher uses a sequence number or timestamp, it does
          not even need to record previous <code>KDFInfo</code>, so long as they are unique.<a href="#section-3.8.1-8" class="pilcrow">¶</a></p>
<p id="section-3.8.1-9">When a Consumer reads a manifest that specifies a <code>KeyNum</code>, the consumer SHOULD
            verify that the Manifest's publisher is an expected one for the KeyNum's usage. This
            trust mechanism employed to ascertain whether the publisher is expected is beyond the
            scope of this document, but we provide an outline of one such possible trust mechanism.
            When a consumer learns a shared key and <code>KeyNum</code>, it associates that
              <code>KeyNum</code> with the publisher ID used in a public key signature. When the
            consumer receives a signed manifest (e.g. the root manifest of a manifest tree), the
            consumer matches the KeyNum's publisher with the Manifest's publisher.<a href="#section-3.8.1-9" class="pilcrow">¶</a></p>
<p id="section-3.8.1-10"> Each encrypted manifest node has a full security context (<code>KeyNum, Nonce,
            Mode</code>). The AEAD decryption is independent for each manifest so Manifest objects can
            be fetched and decrypted in any order. This design also ensures that if a manifest tree
            points to the same subtree repeatedly, such as for deduplication, the decryptions are
            all idempotent.<a href="#section-3.8.1-10" class="pilcrow">¶</a></p>
<p id="section-3.8.1-11">If <code>KDFData</code> is present, one derives a manifest-specific key as:<a href="#section-3.8.1-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.8.1-12">
            <li id="section-3.8.1-12.1">If <code>KDFInfo</code> is present, the TLV (not just the value) is used as the <code>Label</code> below.  
            Otherwise, the Content Object <code>Name</code> TLV (including type type and length fields) 
            is used as the <code>Label</code>.  If the content object does not have a name, it is an error.<a href="#section-3.8.1-12.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-12.2">
              <code>FixedInfo = "FLIC" || KeyNum || AEADMode || Label</code>, where <code>KeyNum</code> 
            and <code>AEADMode</code> are the respecitve TLVs (including type and length).<a href="#section-3.8.1-12.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-12.3">If the publisher and consumer have agreed on a KDF-specific salt, it is used
              as the <code>Salt</code>.  Otherwise, the KDF's default salt is used.<a href="#section-3.8.1-12.3" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-12.4">The derived key will use the left <code>bits</code> of the KDF output to satisfy the
            <code>AEADMode</code> key length (typically 128 or 256 bits).<a href="#section-3.8.1-12.4" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-12.5">DerivedKey = LEFT(KDF(Shared Key, FixedInfo, Salt), bits).<a href="#section-3.8.1-12.5" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.8.1-13">To encrypt a Manifest, the publisher:<a href="#section-3.8.1-13" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.8.1-14">
            <li id="section-3.8.1-14.1">Removes any <code>SecurityCtx</code> or <code>AuthTag</code> from the Manifest.<a href="#section-3.8.1-14.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-14.2">Creates a <code>SecurityCtx</code> and adds it to the Manifest.<a href="#section-3.8.1-14.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-14.3">If <code>KDFData</code> is present, derives a key as above.<a href="#section-3.8.1-14.3" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-14.4">If the publisher and consumer shared a salt, it is used in the encyrption.<a href="#section-3.8.1-14.4" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-14.5">Treats the Manifest TLV through the end of the Node TLV Length as unencrypted
              authenticated Header. That includes anything from the start of the Manifest up to but
              not including the start of the Node's body.<a href="#section-3.8.1-14.5" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-14.6">Treats the body of the Node to the end of the Manifest as encrypted data.<a href="#section-3.8.1-14.6" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-14.7">Appends the AEAD <code>AuthTag</code> to the end of the Manifest, increasing the
              Manifest's length<a href="#section-3.8.1-14.7" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-14.8">Changes the TLV type of the Node to <code>EncryptedNode</code>.<a href="#section-3.8.1-14.8" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.8.1-15">To decrypt a Manifest, the consumer:<a href="#section-3.8.1-15" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.8.1-16">
            <li id="section-3.8.1-16.1">Verifies that the <code>KeyNum</code> exists and the publisher is trusted for that
                <code>KeyNum</code>.<a href="#section-3.8.1-16.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-16.2">Saves the <code>AuthTag</code> and removes it from the Manifest, decreasing the Manifest
              length.<a href="#section-3.8.1-16.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-16.3">Changes the <code>EncryptedNode</code> type to <code>Node</code>.<a href="#section-3.8.1-16.3" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-16.4">Treats everything from the Manifest TLV through the end of the Node Length as
              unencrypted authenticated Header. That is, all bytes from the start of the Manifest up
              to but not including the start of the Node's body.<a href="#section-3.8.1-16.4" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-16.5">Treats the body of the Node to the end of the Manifest as encrypted data.<a href="#section-3.8.1-16.5" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-16.6">If <code>KDFData</code> is present, derives a key as above.<a href="#section-3.8.1-16.6" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-16.7">If the publisher and consumer shared a salt, it is used in the decryption.<a href="#section-3.8.1-16.7" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-16.8">Verifies and decrypts the data using the key and saved <code>AuthTag</code>.<a href="#section-3.8.1-16.8" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.1-16.9">If the decryption fails, the consumer SHOULD notify the user and stop further
              processing of the manifest.<a href="#section-3.8.1-16.9" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="rsa_wrap">
<section id="section-3.8.2">
          <h4 id="name-rsa-oaep-key-transport-mode">
<a href="#section-3.8.2" class="section-number selfRef">3.8.2. </a><a href="#name-rsa-oaep-key-transport-mode" class="section-name selfRef">RSA-OAEP Key Transport Mode</a>
          </h4>
<p id="section-3.8.2-1">The RSA-OAEP mode uses RSA-OAEP (see <span><a href="https://rfc-editor.org/rfc/rfc8017#section-7.1" class="relref">Section 7.1</a> of [<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>) to encrypt a symmetric
            key that is used to encrypt the Manifest. We call this RSA key the Key Encryption Key
            (KEK) and each group member has this private key. A separate key distribuiton system is
            responsible for distributing the KEK. For our purposes, it is reasonable to assume that
            the KEK private key is available at a Locator and that group members can decrypt this
            private key.<a href="#section-3.8.2-1" class="pilcrow">¶</a></p>
<p id="section-3.8.2-2"><code>T_RSA_WRAP_CTX</code> uses <span><a href="#RFC8017" class="internal xref">RSA-OAEP</a> [<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> with mask generation function 
            <span><a href="#RFC8017" class="internal xref">MGF1</a> [<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> and
            the specified hash algorithm.  The hash algorithm number is taken from the IANA registry
            "CCNx Hash Function Types".<a href="#section-3.8.2-2" class="pilcrow">¶</a></p>
<p id="section-3.8.2-3">The <code>RsaOaepData</code> includes an <code>AEADData</code> that indicates how to use the warpped key to
            decrypt the manifest.  It optionally includes the wrapped key itself.  A publisher
            using <code>RsaWrapCtx</code> MUST include the optional wrapped key information in the first
            manifest node that uses it.  The publisher MAY include the wrapped key in other manifest nodes.
            It MUST use distinct <code>KeyNum</code> for distinct <code>WrappedKey</code>.<a href="#section-3.8.2-3" class="pilcrow">¶</a></p>
<p id="section-3.8.2-4">The RSA-OAEP <code>KeyNum</code> is only significant within a given manifest.<a href="#section-3.8.2-4" class="pilcrow">¶</a></p>
<p id="section-3.8.2-5">The <code>AEADData</code> MAY include a <code>KDFData</code> element, in which case it is used the
            same was as with AEAD Mode.<a href="#section-3.8.2-5" class="pilcrow">¶</a></p>
<p id="section-3.8.2-6">In a typical usage, the publisher would begin encryption at the root manifest.  It must
              include the full <code>WrapedData</code> here, as it is the first usage of the <code>KeyNum</code>.
              In subsequent manifests, the publisher may only include the <code>AEADData</code> in
              the <code>RsaOaepData</code> to save space.<a href="#section-3.8.2-6" class="pilcrow">¶</a></p>
<p id="section-3.8.2-7">The <code>KeyId</code> identifies the KEK.  If the consumer already has the key
            corresponding to <code>KeyId</code> locally, it does not need to fetch it from the <code>LocatorPrefixx</code>.
            The <code>KeyId</code> is similar to the Content Object KeyId field <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>.<a href="#section-3.8.2-7" class="pilcrow">¶</a></p>
<p id="section-3.8.2-8">The symmetric key MUST be one that is compatible with the AEAD Mode, i.e. a 128-bit or
            256-bit random number. Further, the symmetric key MUST fit in the OAEP envelope.  Note that for
            a 128-bit key (16 bytes) plus a 4-byte salt requires a minimum 688-bit RSA key and a 256-bit key
            requires a minimum 816-bit RSA key.  So in practical terms, a 1024-bit RSA key is the miniminum
            for the RSA-OAEP encryption with a SHA-256 hash algoirithm.<a href="#section-3.8.2-8" class="pilcrow">¶</a></p>
<p id="section-3.8.2-9">Any group key protocol and system needed are outside the scope of this document. We
            assume there is a Key Manager (KM) and a Publisher (P) and a set of group members.
            Through some means, the Publisher therefore has at its disposal:<a href="#section-3.8.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8.2-10.1">A Content Encryption Key (CEK), i.e. the symmetric key.<a href="#section-3.8.2-10.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.8.2-10.2">The RSA-OAEP wrapped CEK.<a href="#section-3.8.2-10.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.8.2-10.3">The KeyId of the KEK used to wrap the CEK.<a href="#section-3.8.2-10.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.8.2-10.4">The Locator of the KEK, which is shared under some group key protocol.<a href="#section-3.8.2-10.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.8.2-11">This specification requires that if a group member fetches the KEK key at
            Locator, it can decrypt the <code>WrappedKey</code>
            and retrieve the CEK.  The <code>WrappedKey</code>
            includes a 4-byte salt plus an AES key.  The 4-byte salt is used by the AEAD algorithm
            as part of the IV, and MUST remain the same for the given <code>KeyNum</code>.<a href="#section-3.8.2-11" class="pilcrow">¶</a></p>
<p id="section-3.8.2-12">In one example, a publisher could request a key for a group and the Key Manager could
            securely communicate (<code>CEK, Wapped_CEK, KeyId, Locator</code>) back to the publisher.
            The Key Manager is responsible for publishing the Locator. In another example, the
            publisher could be a group member and have a group private key in which case the
            publisher can create their own key encryption key, publish it under the Locator and
            proceed. The publisher generates <code>CEK, Wrapped_CEK, KeyId</code>, and a Locator on its
            own.<a href="#section-3.8.2-12" class="pilcrow">¶</a></p>
<p id="section-3.8.2-13">To create the wrapped key using a Key Encryption Key:<a href="#section-3.8.2-13" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.8.2-14">
            <li id="section-3.8.2-14.1">Obtain the CEK in binary format (e.g. 32 bytes for 256 bits)<a href="#section-3.8.2-14.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.2-14.2">RSA encrypt the <code>WrappedKey</code> value using the KEK public key with OAEP padding, following <span><a href="https://rfc-editor.org/rfc/rfc8017#section-7.1" class="relref">Section 7.1</a> of [<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>. The encryption is not signed because the
              root Manifest must have been signed by the publisher already.  Or the encapsulating
              Content Object (Data Object) is signed via ICN mechanisms.<a href="#section-3.8.2-14.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.8.2-15">To decrypt the wrapped key using a Key Encryption Key:<a href="#section-3.8.2-15" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.8.2-16">
            <li id="section-3.8.2-16.1">RSA decrypt the <code>WrappedKey</code> value using the KEK private key with OAEP padding, following
                <span><a href="https://rfc-editor.org/rfc/rfc8017#section-7.1" class="relref">Section 7.1</a> of [<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>.<a href="#section-3.8.2-16.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.2-16.2">Verify the unwrapped key is a valid length for the AEADMode.<a href="#section-3.8.2-16.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.8.2-17">To encrypt a Manifest, the publisher:<a href="#section-3.8.2-17" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.8.2-18">
            <li id="section-3.8.2-18.1">Acquires the set of (CEK, salt, WrappedKey, KeyId, Locator).  The publisher may
              generate these values itself, or acquire them from a key manager.<a href="#section-3.8.2-18.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.2-18.2">Creates a <code>SecurityCtx</code> and adds it to the Manifest. The <code>SecurityCtx</code>
              includes an <code>AEADNonce</code> and <code>AEADMode</code>, as per AEAD mode.<a href="#section-3.8.2-18.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.2-18.3">Encrypts the Manifest as per AEAD Mode using the RSA-OAEP SecurityCtx and CEK.<a href="#section-3.8.2-18.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.8.2-19">To decrypt a Manifest, the consumer:<a href="#section-3.8.2-19" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.8.2-20">
            <li id="section-3.8.2-20.1">Acquires the RSA private key corresponding to <code>KeyId</code> via the <code>KeyLocator</code>
            or whatever means the publisher and consumers use to distribute keys.<a href="#section-3.8.2-20.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.2-20.2">It SHOULD verify that it trusts the Manifest publisher to use the provided key
              Locator.<a href="#section-3.8.2-20.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.2-20.3">Decrypts the <code>WrappedKey</code> to get the CEK and salt. If the consumer has already decrypted the
              same exact WrappedKey TLV block, it may use that cached CEK and salt.<a href="#section-3.8.2-20.3" class="pilcrow">¶</a>
</li>
            <li id="section-3.8.2-20.4">Using the <code>CEK</code>, <code>AEADNonce</code>, and <code>AEADMode</code>, decrypt the
              Manifest as per AEAD Mode.<a href="#section-3.8.2-20.4" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="encodings">
<section id="section-3.9">
        <h3 id="name-protocol-encodings">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-protocol-encodings" class="section-name selfRef">Protocol Encodings</a>
        </h3>
<div id="CCNxEncoding">
<section id="section-3.9.1">
          <h4 id="name-ccnx-encoding">
<a href="#section-3.9.1" class="section-number selfRef">3.9.1. </a><a href="#name-ccnx-encoding" class="section-name selfRef">CCNx Encoding</a>
          </h4>
<p id="section-3.9.1-1">The CCNx type values are defined in <a href="#IANA" class="auto internal xref">Section 6</a>.  The section <a href="#CCNxTlvs" class="auto internal xref">Section 3.9.1.5</a> goes over
          every TLV structure.<a href="#section-3.9.1-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1-2">In CCNx, application data content objects use a PayloadType of T_PAYLOADTYPE_DATA. In
            order to clearly distinguish FLIC Manifests from application data, a different payload
            type is required. Therefore this specification defines a new payload type of
            T_PAYLOADTYPE_MANIFEST.<a href="#section-3.9.1-2" class="pilcrow">¶</a></p>
<span id="name-ccnx-embedding-grammar"></span><div id="CCNxGrammer">
<figure id="figure-5">
            <div class="lang-abnf sourcecode" id="section-3.9.1-3.1">
<pre>
ManifestContentObject = TYPE LENGTH [Name] [ExpiryTime]
                        PayloadType Payload
Name = TYPE LENGTH *OCTET ; As per RFC8569
ExpiryTime = TYPE LENGTH *OCTET ; As per RFC8569
PayloadType = TYPE LENGTH T_PAYLOADTYPE_MANIFEST ; Value TBD
Payload : TYPE LENGTH *OCTET ; the serialized Manifest object
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-ccnx-embedding-grammar" class="selfRef">CCNx Embedding Grammar</a>
            </figcaption></figure>
</div>
<div id="HashNamingStrategy">
<section id="section-3.9.1.1">
            <h5 id="name-ccnx-hash-naming-strategy">
<a href="#section-3.9.1.1" class="section-number selfRef">3.9.1.1. </a><a href="#name-ccnx-hash-naming-strategy" class="section-name selfRef">CCNx Hash Naming Strategy</a>
            </h5>
<p id="section-3.9.1.1-1">The Hash Naming Strategy uses CCNx nameless content objects and the HashSchema name constructor.  This means that
              only the Root Manifest should have a name embedded in the Content object.  All other
              are CCNx nameless objects.  The Manifest should provide a set of Locators that the client
              may use to form the Interests.<a href="#section-3.9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.1-2">It proceeds as follows:<a href="#section-3.9.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9.1.1-3.1">The Root Manifest content object bound to a name assigned by the publisher and
                signed by the publisher. It also may have a set of Locators used to fetch the
                remainder of the manifest. The root manifest has a single HashPointer that points to
                the Top Manifest. It may also have cache control directives, such as
                ExpiryTime.<a href="#section-3.9.1.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.1-3.2">The Root Manifest has an NsDef that specifies HashSchema. Its GroupData uses that
                NsId. All internal and leaf manifests use the same GroupData NsId. A Manifest Tree
                MAY omit the NsDef and NsId elements and rely on the default being HashSchema.<a href="#section-3.9.1.1-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.1-3.3">The Top Manifest is a nameless CCNx content object. It may have cache control
                directies.<a href="#section-3.9.1.1-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.1-3.4">Internal and Leaf manifests are nameless CCNx content objects, possibly with cache
                control directives.<a href="#section-3.9.1.1-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.1-3.5">The Data content objects are nameless CCNx content objects, possibly with cache
                control directives.<a href="#section-3.9.1.1-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.1-3.6">To form an Interest for a direct or indirect pointer, use a Name from one of the
                Locators and put the pointer HashValue into the ContentObjectHashRestriction.<a href="#section-3.9.1.1-3.6" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="SinglePrefixStrategy">
<section id="section-3.9.1.2">
            <h5 id="name-ccnx-single-prefix-strategy">
<a href="#section-3.9.1.2" class="section-number selfRef">3.9.1.2. </a><a href="#name-ccnx-single-prefix-strategy" class="section-name selfRef">CCNx Single Prefix Strategy</a>
            </h5>
<p id="section-3.9.1.2-1">The Single Prefix strategy uses a named Root manifest and then all
              other data and sub-manifest objects use the same Name.  They are differentiated only by their hash.
              The single prefix name should be different than the root manifest name, to not confuse
              them, as one may wish to use a discovery mechanism on the root manifest and fetch 
              it without a hash restriction.<a href="#section-3.9.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.2-2">It proceeds as follows:<a href="#section-3.9.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9.1.2-3.1">The Root Manifest content object has a name used to fetch the manifest. It is
                signed by the publisher. It has a single Locator used to fetch the remainder of the
                manifest using the commong Single Prefix name. It has a single HashPointer that points to the Top Manifest. It may also
                have cache control directives, such as ExpiryTime.<a href="#section-3.9.1.2-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.2-3.2">The Root Manifest has an NsDef that specifies PrefixSchema with the Locator for the
                single prefix.<a href="#section-3.9.1.2-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.2-3.3">The Top Manifest has the name SinglePrefixName. It may have cache control
                directies. Its GroupData elements must have an NsId that references the NsDef.<a href="#section-3.9.1.2-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.2-3.4">An Internal or Leaf manifest has the name SinglePrefixName, possibly with cache
                control directives. Its GroupData elements must have an NsId that references the
                NsDef.<a href="#section-3.9.1.2-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.2-3.5">The Data content objects have the name SinglePrefixName, possibly with cache
                control directives.<a href="#section-3.9.1.2-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.2-3.6">To form an Interest for a direct or indirect pointer, use SinglePrefixName as the
                Name and put the pointer HashValue into the ContentObjectHashRestriction.<a href="#section-3.9.1.2-3.6" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="SegmentedPrefixStrategy">
<section id="section-3.9.1.3">
            <h5 id="name-ccnx-segmented-prefix-strat">
<a href="#section-3.9.1.3" class="section-number selfRef">3.9.1.3. </a><a href="#name-ccnx-segmented-prefix-strat" class="section-name selfRef">CCNx Segmented Prefix Strategy</a>
            </h5>
<p id="section-3.9.1.3-1">The Segmented Prefix schema uses a different name in all Content Objects and
              distinguishes them via their ContentObjectHash. Note that in CCNx, using a
              SegmentedPrefixSchema means that only the Root Manifest has a Locator for
            the Segmented Prefix (minus the segment number).<a href="#section-3.9.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.3-2">The SegmentedSchema uses name component suffix to distinguish each content object.
              This name component will be of type <code>SuffixComponentType</code>.  In CCNx, this
              would be a <code>ChunkId</code> or <code>ManifestId</code> type (<code>ManifestId</code> is
              defined in this document), though one may specify different types.  The reason
              for specifying the <code>SuffixComponentType</code> in the name definition is that
              application data would typically use chunked names with sequential identifiers and
              the FLIC manifest tree would typically use the <code>ManifestId</code>.<a href="#section-3.9.1.3-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.3-3">A publisher may name the manifest tree and the application data as desired,
                as long as the consumer can generate the required name.  FLIC provides
                two mechanisms: <code>AnnotatedPointers</code> and <code>StartSegmentId</code>.
                One could use an annotated pointer to specify the exact name or name suffix for each pointer,
                so the consumer does not need to calculate anything; it simply uses the name specified.
                The downside is there is an annotation for each pointer, which reduces the number
                possible pointers in a given MTU.  The start segment id is a compact integer per
                hash group that indicates the beginning ID for the pointer array.  The consumer
                calculates each pointer's name suffix from the start segment ID plus pointer offset,
                and then wraps it in a name component of type <code>SuffixComponentType</code>.<a href="#section-3.9.1.3-3" class="pilcrow">¶</a></p>
<p id="section-3.9.1.3-4">Because FLIC uses a preorder tree traversal, the node IDs in the traversal order
                are not compact.  They will skip around based on the preorder recursion.  This means
                one needs a different ID for each manifest if one wants to use the <code>StartSegmentId</code>
                hint.  A publisher may use any form of integer ID in the <code>ManifestId</code> name component
                so long as it is locally (within a hash group) sequential and globally unique.<a href="#section-3.9.1.3-4" class="pilcrow">¶</a></p>
<p id="section-3.9.1.3-5">It proceeds as follows:<a href="#section-3.9.1.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9.1.3-6.1">The Root Manifest content object has a name used to fetch the manifest. It is
                signed by the publisher. It has a set of Locators used to fetch the remainder of the
                manifest. It has a single HashPointer that points to the Top Manifest. It may also
                have cache control directives, such as ExpiryTime.<a href="#section-3.9.1.3-6.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.3-6.2">The Root Manifest has an NsDef that specifies SegmentedPrefix and the
                SegmentedPrefixSchema element specifies the SegmentedPrefixName.<a href="#section-3.9.1.3-6.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.3-6.3">The publisher tracks the chunk number of each content object within the NsId.
                Objects are be numbered in their traversal order. Within each manifest, the name can
                be constructed from the SegmentedPrefixName plus a Chunk name component.<a href="#section-3.9.1.3-6.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.3-6.4">The Top Manifest has the name SegmentedPrefixName plus chunk number. It may have
                cache control directies. It's GroupData elements must have an NsId that references
                the NsDef.<a href="#section-3.9.1.3-6.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.3-6.5">An Internal or Leaf manifest has the name SegmentedPrefixName plus chunk number,
                possibly with cache control directives. Its GroupData elements must have an NsId
                that references the NsDef.<a href="#section-3.9.1.3-6.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.3-6.6">The Data content objects have the name SegmentedPrefixName plus chunk number,
                possibly with cache control directives.<a href="#section-3.9.1.3-6.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.1.3-6.7">To form an Interest for a direct or indirect pointer, use SegmentedPrefixName plus
                chunk number as the Name and put the pointer HashValue into the
                ContentObjectHashRestriction. A consumer must track the chunk number in traversal
                order for each SegmentedPrefixSchema NsId.<a href="#section-3.9.1.3-6.7" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="HybridStrategy">
<section id="section-3.9.1.4">
            <h5 id="name-ccnx-hybrid-strategy">
<a href="#section-3.9.1.4" class="section-number selfRef">3.9.1.4. </a><a href="#name-ccnx-hybrid-strategy" class="section-name selfRef">CCNx Hybrid Strategy</a>
            </h5>
<p id="section-3.9.1.4-1">A manifest may use multiple schemas. For example, the application payload in data
              content objects might use SegmentedPrefix while the manifest content objects might use
              HashNaming.<a href="#section-3.9.1.4-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.4-2">The Root Manifest should specify an NsDef with a first NsId (say 1) as the HashNaming
              schema and a second NsDef with a second NsId (say 2) as the SegmentedPrefix schema
              along with the SegmentedPrefixName.<a href="#section-3.9.1.4-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.4-3">Each manifest (Top, Internal, Leaf) uses two or more HashGroups, where each HashGroup
              has only Direct (with the second NsId) or Indirect (with the first NsId). The number
              of hash groups will depend on how the publisher wishes to interleave direct and
              indirect pointers.<a href="#section-3.9.1.4-3" class="pilcrow">¶</a></p>
<p id="section-3.9.1.4-4">Manifests and data objects derive their names according to the application's naming
              schema.<a href="#section-3.9.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CCNxTlvs">
<section id="section-3.9.1.5">
            <h5 id="name-ccnx-tlv-encodings">
<a href="#section-3.9.1.5" class="section-number selfRef">3.9.1.5. </a><a href="#name-ccnx-tlv-encodings" class="section-name selfRef">CCNx TLV Encodings</a>
            </h5>
<p id="section-3.9.1.5-1">This section defines each CCNx TLV encoding and the format of the TLV values.<a href="#section-3.9.1.5-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5-2">FLIC uses variable length integer encodings in several places.  We use the term
              <code>varint</code> to be a network byte order unsigned integer of length 1 - 8 octets.
              This applies to all fields defined as "INTEGER" in the grammar: <code>T_SUBTREE_SIZE,
              T_LEAF_SIZE, T_NCID, T_KEYNUM</code>.<a href="#section-3.9.1.5-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5-3">FLIC encodes hash values as per <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>.  That is,
            as a hash algorithm type, the length, and the hash output in the value.
            This applies to any field in the grammar defined as "HashValue": <code>T_SUBTREE_DIGEST, 
            T_LEAF_DIGEST, T_PTRS (an array of HashValue), T_PTR, T_KEYID</code>.<a href="#section-3.9.1.5-3" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5-4">The CCNx encoding allows for vendor extensions (<code>T_ORG</code>) in several places,
              as per <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>.
              A parser may skip over any <code>T_ORG</code> it does not implement.  Where appropriate,
              we show an optional <code>T_ORG</code> tlv where allowed.<a href="#section-3.9.1.5-4" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5-5">The CCNx encoding allows for experimental type identifiers (0x1000-0x1FFF) in most
                TLV contexts.  A parser may skip over any experimental TLV it does not implement.
                We do not show experimental TLVs in the artwork below.<a href="#section-3.9.1.5-5" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5-6">There is no required order of TLV blocks withhin a TLV context.  We show the
                  RECOMMENDED ordering of TLV blocks.  TLV blocks MUST NOT repeat unless
                  specifically allowed in the <span><a href="#grammar" class="internal xref">grammar</a> (<a href="#grammar" class="auto internal xref">Section 3.6</a>)</span>.<a href="#section-3.9.1.5-6" class="pilcrow">¶</a></p>
<div id="tlv_manifest">
<section id="section-3.9.1.5.1">
              <h6 id="name-manifest-tlv">
<a href="#section-3.9.1.5.1" class="section-number selfRef">3.9.1.5.1. </a><a href="#name-manifest-tlv" class="section-name selfRef">Manifest TLV</a>
              </h6>
<p id="section-3.9.1.5.1-1">A Manifest has an outer TLV type that identifies type kind of manifest inside a Content Object
          with a payload type of <code>T_PAYLOADTYPE_MANIFEST</code>.  FLIC is defined as type <code>T_FLIC_MANIFEST</code>.<a href="#section-3.9.1.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.1-2">A FLIC Manifest may be plaintext or encrypted.  A plaintext manifest usually only has a Node.
            But it may also have a Security Context, Node, and Authentication Tag.  This can happen when a manifest
            is in-place decrypted.  In place decryption operates on the body of the <code>EncryptedNode</code> TLV and
            then changes the type from <code>T_ENCRYPTED_NODE</code> to <code>T_NODE</code>.<a href="#section-3.9.1.5.1-2" class="pilcrow">¶</a></p>
<span id="name-flic-manifest-tlv-container"></span><figure id="figure-6">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.1-3.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|        T_FLIC_MANIFEST        |             Length            |
+---------------+---------------+---------------+---------------+
/                       [Security Context]                      /
+---------------+---------------+---------------+---------------+
/                      Node or EncryptedNode                    /
+---------------+---------------+---------------+---------------+
/                      [Authentication Tag]                     /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-flic-manifest-tlv-container" class="selfRef">FLIC manifest TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_security_ctx">
<section id="section-3.9.1.5.2">
              <h6 id="name-securityctx-tlv">
<a href="#section-3.9.1.5.2" class="section-number selfRef">3.9.1.5.2. </a><a href="#name-securityctx-tlv" class="section-name selfRef">SecurityCtx TLV</a>
              </h6>
<p id="section-3.9.1.5.2-1">The <code>SecurityCtx</code> TLV wraps an <code>AlgroithmCtx</code>, which may be either a
        symmetric key encryption context <code>AEADCtx</code> or an assymetric key wrapping
        of the decryption key, <code>RsaWrapCtx</code>.<a href="#section-3.9.1.5.2-1" class="pilcrow">¶</a></p>
<span id="name-flic-security-context-tlv-c"></span><figure id="figure-7">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.2-2.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|        T_SECURITY_CTX         |             Length            |
+---------------+---------------+---------------+---------------+
/                      AEADCtx or RsaWrapCtx                    /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-flic-security-context-tlv-c" class="selfRef">FLIC Security Context TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_aead_ctx">
<section id="section-3.9.1.5.3">
              <h6 id="name-aead-context-tlv">
<a href="#section-3.9.1.5.3" class="section-number selfRef">3.9.1.5.3. </a><a href="#name-aead-context-tlv" class="section-name selfRef">AEAD Context TLV</a>
              </h6>
<p id="section-3.9.1.5.3-1">The <code>AEADCtx</code> identifies a symmetric key shared by the publisher and consumer.
        It is identified by a <code>KeyNum</code>, which may be an small integer (e.g. within a
        TLS-like session) or a longer integer.  CCNx uses upto a 64-bit integer.<a href="#section-3.9.1.5.3-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.3-2">The <code>AEADNonce</code> is used to generate the encryption IV, as descbribed
        in <a href="#aead" class="auto internal xref">Section 3.8.1</a>.  It is an octet string.<a href="#section-3.9.1.5.3-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.3-3">The <code>AEADMode</code> is an integer that identifes the encryption algorithm.
        All defined values fit within 1 octet.  The IANA registry "AEAD Algorithms"
        allows for up to 2 octets.<a href="#section-3.9.1.5.3-3" class="pilcrow">¶</a></p>
<span id="name-flic-aead-context-tlv-conta"></span><figure id="figure-8">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.3-4.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|           T_AEAD_CTX          |             Length            |
+---------------+---------------+---------------+---------------+
|           T_KEY_NUM           |             Length            |
+---------------+---------------+---------------+---------------+
/                           &lt;varint&gt;                            /
+---------------+---------------+---------------+---------------+
|           T_NONCE             |             Length            |
+---------------+---------------+---------------+---------------+
/                           1*OCTET                             /
+---------------+---------------+---------------+---------------+
|          T_AEAD_MODE          |             Length            |
+---------------+---------------+---------------+---------------+
/                           &lt;varint&gt;                            /
+---------------+---------------+---------------+---------------+
/                           [KDFData]                           /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-flic-aead-context-tlv-conta" class="selfRef">FLIC AEAD Context TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_rsa_wrap_ctx">
<section id="section-3.9.1.5.4">
              <h6 id="name-rsa-oaep-context-tlv">
<a href="#section-3.9.1.5.4" class="section-number selfRef">3.9.1.5.4. </a><a href="#name-rsa-oaep-context-tlv" class="section-name selfRef">RSA-OAEP Context TLV</a>
              </h6>
<p id="section-3.9.1.5.4-1">The <code>RsaOaepData</code> has a mandatory <code>AEADData</code>
        section plus optional <code>RsaOaepData</code>.  Note that
        in the grammar, those are not TLV containers, but simply
        data records.  The figure below shows an <code>RsaOaepCtx</code>
        with all parameters.<a href="#section-3.9.1.5.4-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.4-2">The HashAlg value is an unsigned 16-bit integer in
          network byte order.<a href="#section-3.9.1.5.4-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.4-3">The wrapped key value is the RSA-OAEP cyphertext of
          the <code>WrappedKey</code> record.<a href="#section-3.9.1.5.4-3" class="pilcrow">¶</a></p>
<span id="name-flic-rsa-oaep-tlv-container"></span><figure id="figure-9">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.4-4.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|         T_RSAOAEP_CTX         |             Length            |
+---------------+---------------+---------------+---------------+
|           T_KEY_NUM           |             Length            |
+---------------+---------------+---------------+---------------+
/                           &lt;varint&gt;                            /
+---------------+---------------+---------------+---------------+
|           T_NONCE             |             Length            |
+---------------+---------------+---------------+---------------+
/                           1*OCTET                             /
+---------------+---------------+---------------+---------------+
|          T_AEAD_MODE          |             Length            |
+---------------+---------------+---------------+---------------+
/                           &lt;varint&gt;                            /
+---------------+---------------+---------------+---------------+
|          T_KDF_DATA           |             Length            |
+---------------+---------------+---------------+---------------+
/                       &lt;kdf structure&gt;                         /
+---------------+---------------+---------------+---------------+
|            T_KEYID            |             Length            |
+---------------+---------------+---------------+---------------+
/                            1*OCTET                            /
+---------------+---------------+---------------+---------------+
|            T_KEYLINK          |             Length            |
+---------------+---------------+---------------+---------------+
/                          &lt;ccnx link&gt;                          /
+---------------+---------------+---------------+---------------+
|           T_HASH_ALG          |               2               |
+---------------+---------------+---------------+---------------+
|           16-bit int          |
+---------------+---------------+---------------+---------------+
|         T_WRAPPED_KEY         |             Length            |
+---------------+---------------+---------------+---------------+
/                  &lt;RSA-OAEP encrypted octets&gt;                  /
+---------------+---------------+---------------+---------------+

</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-flic-rsa-oaep-tlv-container" class="selfRef">FLIC RSA-OAEP TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_node">
<section id="section-3.9.1.5.5">
              <h6 id="name-node-tlv">
<a href="#section-3.9.1.5.5" class="section-number selfRef">3.9.1.5.5. </a><a href="#name-node-tlv" class="section-name selfRef">Node TLV</a>
              </h6>
<p id="section-3.9.1.5.5-1">The <code>Node</code> contains the manifest information.  It has an
        optional NodeData, plus one or more hash groups.<a href="#section-3.9.1.5.5-1" class="pilcrow">¶</a></p>
<span id="name-flic-node-tlv-container"></span><figure id="figure-10">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.5-2.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|            T_NODE             |             Length            |
+---------------+---------------+---------------+---------------+
/                           [NodeData]                          /
+---------------+---------------+---------------+---------------+
/                          1*HashGroup                          /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-flic-node-tlv-container" class="selfRef">FLIC Node TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_node_data">
<section id="section-3.9.1.5.6">
              <h6 id="name-node-data-tlv">
<a href="#section-3.9.1.5.6" class="section-number selfRef">3.9.1.5.6. </a><a href="#name-node-data-tlv" class="section-name selfRef">Node Data TLV</a>
              </h6>
<p id="section-3.9.1.5.6-1"><code>NodeData</code> has no mandatory fields, but several optional fields.
        If no fields are present, a publisher should omit the entire <code>NodeData</code>
        TLV container.<a href="#section-3.9.1.5.6-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.6-2">SubtreeSize, SubtreeDigest, and Vendor are encoded as previously specified
          (<code>INTEGER</code>, <code>HashValue</code>, and <code>T_ORG</code>, respectively).<a href="#section-3.9.1.5.6-2" class="pilcrow">¶</a></p>
<span id="name-flic-nodedata-tlv-container"></span><figure id="figure-11">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.6-3.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|          T_NODE_DATA          |             Length            |
+---------------+---------------+---------------+---------------+
/                         [SubtreeSize]                         /
+---------------+---------------+---------------+---------------+
/                         [SubtreeDigest]                       /
+---------------+---------------+---------------+---------------+
/                           [Locators]                          /
+---------------+---------------+---------------+---------------+
/                             0*NcDef                           /
+---------------+---------------+---------------+---------------+
/                            0*Vendor                           /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-flic-nodedata-tlv-container" class="selfRef">FLIC NodeData TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_locators">
<section id="section-3.9.1.5.7">
              <h6 id="name-locators-tlv">
<a href="#section-3.9.1.5.7" class="section-number selfRef">3.9.1.5.7. </a><a href="#name-locators-tlv" class="section-name selfRef">Locators TLV</a>
              </h6>
<p id="section-3.9.1.5.7-1"><code>Locators</code> is a TLV container around a list s
        <code>Locator</code> entries.  Each <code>Locator</code> wraps a CCN x Link <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.4" class="relref">Section 3.3.4</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>.
        In the CCNx draft, "Link" does not have its own TLV type, but rather is embedded inside a type
        with specific meaning, such as KeyLink or PublicKeyLocator.<a href="#section-3.9.1.5.7-1" class="pilcrow">¶</a></p>
<span id="name-flic-locators-tlv-container"></span><figure id="figure-12">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.7-2.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|          T_LOCATORS           |             Length            |
+---------------+---------------+---------------+---------------+
/                           1*Locator                           /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-flic-locators-tlv-container" class="selfRef">FLIC Locators TLV container</a>
                </figcaption></figure>
<span id="name-flic-locator-tlv-container"></span><figure id="figure-13">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.7-3.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|          T_LOCATOR            |             Length            |
+---------------+---------------+---------------+---------------+
/                             LINK                              /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-flic-locator-tlv-container" class="selfRef">FLIC Locator TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_ncdef">
<section id="section-3.9.1.5.8">
              <h6 id="name-name-constructor-definition">
<a href="#section-3.9.1.5.8" class="section-number selfRef">3.9.1.5.8. </a><a href="#name-name-constructor-definition" class="section-name selfRef">Name Constructor Definition TLV</a>
              </h6>
<p id="section-3.9.1.5.8-1"><code>NcDef</code> provides the information needed for a consumer to
        construct an Interest from a manifest pointer.  The information is
        in a Name Constructor Schema.<a href="#section-3.9.1.5.8-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.8-2"><code>NcId</code> is encoded as an INTEGER, as previously defined.<a href="#section-3.9.1.5.8-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.8-3"><code>NcSchema</code> may include <code>ProtocolFlags</code>, which are TLVs
        intended to be included in an Interest.  These may control discovery or
        response freshness.  The value of protocol flags is ICN specific.<a href="#section-3.9.1.5.8-3" class="pilcrow">¶</a></p>
<span id="name-flic-name-constructor-defin"></span><figure id="figure-14">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.8-4.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|            T_NCDEF            |             Length            |
+---------------+---------------+---------------+---------------+
/                              NcId                             /
+---------------+---------------+---------------+---------------+
/                            NcSchema                           /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-flic-name-constructor-defin" class="selfRef">FLIC Name Constructor Definition TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_hash_schema">
<section id="section-3.9.1.5.9">
              <h6 id="name-hash-schema-tlv">
<a href="#section-3.9.1.5.9" class="section-number selfRef">3.9.1.5.9. </a><a href="#name-hash-schema-tlv" class="section-name selfRef">Hash Schema TLV</a>
              </h6>
<p id="section-3.9.1.5.9-1">The <code>HashSchema</code> uses CCNx nameless objects.  It must have
        one or more locators.<a href="#section-3.9.1.5.9-1" class="pilcrow">¶</a></p>
<span id="name-flic-hash-schema-tlv-contai"></span><figure id="figure-15">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.9-2.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|         T_HASH_SCHEMA         |             Length            |
+---------------+---------------+---------------+---------------+
|           T_LOCATORS          |             Length            |
+---------------+---------------+---------------+---------------+
/                           1*LOCATOR                           /
+---------------+---------------+---------------+---------------+
/                         [ProtocolFlags]                       /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-flic-hash-schema-tlv-contai" class="selfRef">FLIC Hash Schema TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_prefix_schema">
<section id="section-3.9.1.5.10">
              <h6 id="name-prefix-schema-tlv">
<a href="#section-3.9.1.5.10" class="section-number selfRef">3.9.1.5.10. </a><a href="#name-prefix-schema-tlv" class="section-name selfRef">Prefix Schema TLV</a>
              </h6>
<p id="section-3.9.1.5.10-1">The <code>PrefixSchema</code> uses named content objects.
        CCNx uses the provided name and does not use locators.<a href="#section-3.9.1.5.10-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.10-2">The <code>Name</code> is encoded as <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.6.1" class="relref">Section 3.6.1</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>.<a href="#section-3.9.1.5.10-2" class="pilcrow">¶</a></p>
<span id="name-flic-prefix-schema-tlv-cont"></span><figure id="figure-16">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.10-3.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|        T_PREFIX_SCHEMA        |             Length            |
+---------------+---------------+---------------+---------------+
/                              Name                             /
+---------------+---------------+---------------+---------------+
/                         [ProtocolFlags]                       /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-flic-prefix-schema-tlv-cont" class="selfRef">FLIC Prefix Schema TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_segmented_schema">
<section id="section-3.9.1.5.11">
              <h6 id="name-segmented-schema-tlv">
<a href="#section-3.9.1.5.11" class="section-number selfRef">3.9.1.5.11. </a><a href="#name-segmented-schema-tlv" class="section-name selfRef">Segmented Schema TLV</a>
              </h6>
<p id="section-3.9.1.5.11-1">The <code>SegmentedSchema</code> uses named content objects.
        Each object has a name prefix plus a unique suffix.  
        The suffix is encoded with NameComponent type <code>SuffixComponentType</code>.
        CCNx uses the provided name and does not use locators.<a href="#section-3.9.1.5.11-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.11-2">The <code>Name</code> is encoded as <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.6.1" class="relref">Section 3.6.1</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>.<a href="#section-3.9.1.5.11-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.11-3">In CCNx, the <code>SuffixComponentType</code> must be 2 octets, as per
        the CCNx TLV type size.<a href="#section-3.9.1.5.11-3" class="pilcrow">¶</a></p>
<span id="name-flic-segmented-schema-tlv-c"></span><figure id="figure-17">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.11-4.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|       T_SEGMENTED_SCHEMA      |             Length            |
+---------------+---------------+---------------+---------------+
/                              Name                             /
+---------------+---------------+---------------+---------------+
|         T_SUFFIX_TYPE         |               2               |
+---------------+---------------+---------------+---------------+
|       Name Component Type     |
+---------------+---------------+---------------+---------------+
/                         [ProtocolFlags]                       /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-flic-segmented-schema-tlv-c" class="selfRef">FLIC Segmented Schema TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_hash_group">
<section id="section-3.9.1.5.12">
              <h6 id="name-hash-group-tlv">
<a href="#section-3.9.1.5.12" class="section-number selfRef">3.9.1.5.12. </a><a href="#name-hash-group-tlv" class="section-name selfRef">Hash Group TLV</a>
              </h6>
<p id="section-3.9.1.5.12-1">A <code>HashGroup</code> encloses a series of hash values.
        It has an optional <code>GroupData</code> that applies to all the
        pointers in the group.<a href="#section-3.9.1.5.12-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.12-2">The pointers are bundled in either a <code>Ptrs</code> list
        or an <code>AnnotatedPtrs</code> list.<a href="#section-3.9.1.5.12-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.12-3"><code>Ptrs</code> is an array
        of raw CCNx hash values entries (i.e. SHA256 TLVs), as per
        <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>.
        Each entry MAY be a different hash type and different TLV length,
        so a parser must use the hash TLV type and TLV length fields
        of each entry.<a href="#section-3.9.1.5.12-3" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.12-4"><code>AnotatedPtrs</code> is a list of annotations for each pointer.<a href="#section-3.9.1.5.12-4" class="pilcrow">¶</a></p>
<span id="name-flic-hash-group-tlv-contain"></span><figure id="figure-18">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.12-5.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|          T_HASH_GROUP         |             Length            |
+---------------+---------------+---------------+---------------+
/                          [GroupData]                          /
+---------------+---------------+---------------+---------------+
/                      Ptrs or AnnotatedPtrs                    /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-flic-hash-group-tlv-contain" class="selfRef">FLIC Hash Group TLV container</a>
                </figcaption></figure>
<span id="name-flic-ptrs-tlv-container"></span><figure id="figure-19">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.12-6.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|             T_PTRS            |             Length            |
+---------------+---------------+---------------+---------------+
/                          1*HashValue                          /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-flic-ptrs-tlv-container" class="selfRef">FLIC Ptrs TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_group_data">
<section id="section-3.9.1.5.13">
              <h6 id="name-group-data-tlv">
<a href="#section-3.9.1.5.13" class="section-number selfRef">3.9.1.5.13. </a><a href="#name-group-data-tlv" class="section-name selfRef">Group Data TLV</a>
              </h6>
<p id="section-3.9.1.5.13-1">The <code>GroupData</code> is a set of optional fields.
        The encoding of these fields has been previously described
        (NcId, INTEGER, HashValue, T_ORG).<a href="#section-3.9.1.5.13-1" class="pilcrow">¶</a></p>
<span id="name-flic-group-data-tlv-contain"></span><figure id="figure-20">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.13-2.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|         T_GROUP_DATA          |             Length            |
+---------------+---------------+---------------+---------------+
/                             [NcId]                            /
+---------------+---------------+---------------+---------------+
/                          [LeafSize]                           /
+---------------+---------------+---------------+---------------+
/                         [LeafDigest]                          /
+---------------+---------------+---------------+---------------+
/                         [SubtreeSize]                         /
+---------------+---------------+---------------+---------------+
/                        [SubtreeDigest]                        /
+---------------+---------------+---------------+---------------+
/                        [StartSegmentId]                       /
+---------------+---------------+---------------+---------------+
/                            0*Vendor                           /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-flic-group-data-tlv-contain" class="selfRef">FLIC Group Data TLV container</a>
                </figcaption></figure>
</section>
</div>
<div id="tlv_annotated_ptrs">
<section id="section-3.9.1.5.14">
              <h6 id="name-annotated-pointers-tlv">
<a href="#section-3.9.1.5.14" class="section-number selfRef">3.9.1.5.14. </a><a href="#name-annotated-pointers-tlv" class="section-name selfRef">Annotated Pointers TLV</a>
              </h6>
<p id="section-3.9.1.5.14-1"><code>AnnotatedPtrs</code> is a list of one or more <code>PointerBlocks</code>.
        Each pointer block is one pointer plus zero or more annotations.<a href="#section-3.9.1.5.14-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.14-2">Annotations should not repeat in the same pointer block, unless specifically
          allowed by the annotation.<a href="#section-3.9.1.5.14-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1.5.14-3">The defined annotations (SizeAnnotation, SegmentIdAnnotation, and LinkAnnotation)
          all use previously defined encodings (INTEGER or Name) and are not shown here.<a href="#section-3.9.1.5.14-3" class="pilcrow">¶</a></p>
<span id="name-flic-annotated-pointers-tlv"></span><figure id="figure-21">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.14-4.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|       T_ANNOTATED_PTRS        |             Length            |
+---------------+---------------+---------------+---------------+
/                         1*PointerBlock                        /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-flic-annotated-pointers-tlv" class="selfRef">FLIC Annotated Pointers TLV container</a>
                </figcaption></figure>
<span id="name-flic-pointer-block-tlv-cont"></span><figure id="figure-22">
                <div class="alignLeft art-text artwork" id="section-3.9.1.5.14-5.1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|          T_PTR_BLOCK          |             Length            |
+---------------+---------------+---------------+---------------+
|             T_PTR             |             Length            |
+---------------+---------------+---------------+---------------+
/                           HashValue                           /
+---------------+---------------+---------------+---------------+
/                          *Annotation                          /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-flic-pointer-block-tlv-cont" class="selfRef">FLIC Pointer Block TLV container</a>
                </figcaption></figure>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="NDNEncoding">
<section id="section-3.9.2">
          <h4 id="name-ndn-encoding">
<a href="#section-3.9.2" class="section-number selfRef">3.9.2. </a><a href="#name-ndn-encoding" class="section-name selfRef">NDN Encoding</a>
          </h4>
<p id="section-3.9.2-1">In NDN, all Manifest Data objects use a ContentType of FLIC (1024), while all
            application data content objects use a PayloadType of Blob.<a href="#section-3.9.2-1" class="pilcrow">¶</a></p>
<div id="NDNHashNaming">
<section id="section-3.9.2.1">
            <h5 id="name-ndn-hash-naming">
<a href="#section-3.9.2.1" class="section-number selfRef">3.9.2.1. </a><a href="#name-ndn-hash-naming" class="section-name selfRef">NDN Hash Naming</a>
            </h5>
<p id="section-3.9.2.1-1">In NDN Hash Naming, a Data Object has a 0-length name. This means that an Interest
              will only have an ImplicitDigest name component in it. This method relies on using NDN
              Forwarding Hints.<a href="#section-3.9.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.9.2.1-2">It proceeds as follows:<a href="#section-3.9.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9.2.1-3.1">The Root Manifest Data has a name used to fetch the manifest. It is signed by the
                publisher. It has a set of Locators used to fetch the remainder of the manifest. It
                has a single HashPointer that points to the Top Manifest. It may also have cache
                control directives.<a href="#section-3.9.2.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.1-3.2">The Root Manifest has an NsDef that specifies HashSchema. Its GroupData uses that
                NsId. All internal and leaf manifests use the same GroupData NsId. A Manifest Tree
                MAY omit the NsDef and NsId elements and rely on the default being HashSchema.<a href="#section-3.9.2.1-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.1-3.3">The Top Manifest has a 0-length Name. It may have cache control directies.<a href="#section-3.9.2.1-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.1-3.4">Internal and Leaf manifests has a 0-length Name, possibly with cache control
                directives.<a href="#section-3.9.2.1-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.1-3.5">The application Data use a 0-length name, possibly with cache control
                directives.<a href="#section-3.9.2.1-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.1-3.6">To form an Interest for a direct or indirect pointer, the name is only the
                Implicit Digest name component derived from a pointer's HashValue. The
                ForwardingHints come from the Locators. In NDN, one may use one or more locators
                within a single Interest.<a href="#section-3.9.2.1-3.6" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="NDNSinglePrefix">
<section id="section-3.9.2.2">
            <h5 id="name-ndn-single-prefix">
<a href="#section-3.9.2.2" class="section-number selfRef">3.9.2.2. </a><a href="#name-ndn-single-prefix" class="section-name selfRef">NDN Single Prefix</a>
            </h5>
<p id="section-3.9.2.2-1">In Single Prefix, the Data name is a common prefix used between all objects in that
              namespace, without a Segment or other counter. They are distinguished via the Implicit
              Digest name component. The FLIC Locators go in the ForwardingHints.<a href="#section-3.9.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.9.2.2-2">It proceeds as follows:<a href="#section-3.9.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9.2.2-3.1">The Root Manifest Data object has a name used to fetch the manifest. It is signed
                by the publisher. It has a set of Locators used to fetch the remainder of the
                manifest. It has a single HashPointer that points to the Top Manifest. It may also
                have cache control directives.<a href="#section-3.9.2.2-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.2-3.2">The Root Manifest has an NsDef that specifies SinglePrefix and the
                SinglePrefixSchema element specifies the SinglePrefixName.<a href="#section-3.9.2.2-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.2-3.3">The Top Manifest has the name SinglePrefixName. It may have cache control
                directies. Its GroupData elements must have an NsId that references the NsDef.<a href="#section-3.9.2.2-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.2-3.4">An Internal or Leaf manifest has the name SinglePrefixName, possibly with cache
                control directives. Its GroupData elements must have an NsId that references the
                NsDef.<a href="#section-3.9.2.2-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.2-3.5">The Data content objects have the name SinglePrefixName, possibly with cache
                control directives.<a href="#section-3.9.2.2-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.2-3.6">To form an Interest for a direct or indirect pointer, use SinglePrefixName as the
                Name and append the pointer's HashValue into an ImplicitDigest name component. Set
                the ForwardingHints from the FLIC locators.<a href="#section-3.9.2.2-3.6" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="NDNSegmentedPrefix">
<section id="section-3.9.2.3">
            <h5 id="name-ndn-segmented-prefix">
<a href="#section-3.9.2.3" class="section-number selfRef">3.9.2.3. </a><a href="#name-ndn-segmented-prefix" class="section-name selfRef">NDN Segmented Prefix</a>
            </h5>
<p id="section-3.9.2.3-1">In Segmented Prefix, the Data name is a common prefix plus a segment number, so each
              manifest or application data object has a unique full name before the implicit digest.
              This means the consumer must maintain a counter for each SegmentedPrefix
              namespace.<a href="#section-3.9.2.3-1" class="pilcrow">¶</a></p>
<aside id="section-3.9.2.3-2">
              <p id="section-3.9.2.3-2.1"><strong>Optional</strong>: Use AnnotatedPointers to indicate the segment number of
                each hash pointer to avoid needing to infer the segment numbers.<a href="#section-3.9.2.3-2.1" class="pilcrow">¶</a></p>
<p id="section-3.9.2.3-2.2"><strong>Optional</strong>: Use StartSegmentId in GroupData to indicate the segment number of
                for each group.  The producer must ensure that each subsequent GroupData starts
                at the correct offset.<a href="#section-3.9.2.3-2.2" class="pilcrow">¶</a></p>
</aside>
<p id="section-3.9.2.3-3">It proceeds as follows:<a href="#section-3.9.2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9.2.3-4.1">The Root Manifest Data object has a name used to fetch the manifest. It is signed
                by the publisher. It has a set of Locators used to fetch the remainder of the
                manifest. It has a single HashPointer that points to the Top Manifest. It may also
                have cache control directives.<a href="#section-3.9.2.3-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.3-4.2">The Root Manifest has an NsDef that specifies SegmentedPrefix and the
                SegmentedPrefixSchema element specifies the SegmentedPrefixName.<a href="#section-3.9.2.3-4.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.3-4.3">The publisher tracks the segment number of each Data object within a
                SegmentedPrefix NsId. Data is numbered in traversal order. Within each manifest, the
                name is constructed from the SegmentedPrefixName plus a Segment name component.<a href="#section-3.9.2.3-4.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.3-4.4">The Top Manifest has the name SegmentedPrefixName plus segment number. It may have
                cache control directies. Its GroupData elements must have an NsId that references
                the NsDef.<a href="#section-3.9.2.3-4.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.3-4.5">An Internal or Leaf manifest has the name SegmentedPrefixName plus segment number,
                possibly with cache control directives. Its GroupData elements must have an NsId
                that references the NsDef.<a href="#section-3.9.2.3-4.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.3-4.6">The Data content objects have the name SegmentedPrefixName plus chunk number,
                possibly with cache control directives.<a href="#section-3.9.2.3-4.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.9.2.3-4.7">To form an Interest for a direct or indirect pointer, use SegmentedPrefixName plus
                segment number as the Name and put the pointer HashValue into the ImplicitDigest
                name component. A consumer must track the segment number in traversal order for each
                SegmentedPrefixSchema NsId.<a href="#section-3.9.2.3-4.7" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="NDNHybrid">
<section id="section-3.9.2.4">
            <h5 id="name-ndn-hybrid-schema">
<a href="#section-3.9.2.4" class="section-number selfRef">3.9.2.4. </a><a href="#name-ndn-hybrid-schema" class="section-name selfRef">NDN Hybrid Schema</a>
            </h5>
<p id="section-3.9.2.4-1">A manifest may use multiple schemas. For example, the application payload in data
              content objects might use SegmentedPrefix while the manifest content objects might use
              HashNaming.<a href="#section-3.9.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.9.2.4-2">The Root Manifest should specify an NsDef with a first NsId (say 1) as the HashNaming
              schema and a second NsDef with a second NsId (say 2) as the SegmentedPrefix schema
              along with the SegmentedPrefixName.<a href="#section-3.9.2.4-2" class="pilcrow">¶</a></p>
<p id="section-3.9.2.4-3">Each manifest (Top, Internal, Leaf) uses two or more HashGroups, where eash HashGroup
              has only Direct (with the second NsId) or Indirect (with the first NsId). The number
              of hash groups will depend on how the publisher wishes to interleave direct and
              indirect pointers.<a href="#section-3.9.2.4-3" class="pilcrow">¶</a></p>
<p id="section-3.9.2.4-4">Manifests and data objects derive their names according to the application's naming
              schema.<a href="#section-3.9.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="explain_segmented">
<section id="section-3.9.3">
          <h4 id="name-segmented-schema-details">
<a href="#section-3.9.3" class="section-number selfRef">3.9.3. </a><a href="#name-segmented-schema-details" class="section-name selfRef">Segmented Schema Details</a>
          </h4>
<p id="section-3.9.3-1">When using CCNx Segmented Prefix Strategy or NDN Segmented Prefix strategy, the
          consumer must determine the segment number to use in the name.  Typically, the
          application data would use a chunk (segment) ID in the content name, which is a
          compact sequence number.  These could be computed based on the in-order traversal,
          assuming one knows which manifests point to data versus other manifests.
          Manifests, however, may not use a compact sequence number and there is no simple
          way to predict the names.<a href="#section-3.9.3-1" class="pilcrow">¶</a></p>
<p id="section-3.9.3-2">There are two methods to guide a consumer in generating segment IDs for
            hash pointers:<a href="#section-3.9.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9.3-3.1">If fetching a pointer with a SegmentIdAnnotation, the consumer MUST use that
              segment number for the pointer.  A pointer with SegmentIdAnnotation does not
              increment the SegmentId used by the GroupData case.<a href="#section-3.9.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.9.3-3.2">If the GroupData has a StartSegmentId parameter, then that segment number MUST
              be used for the first in-order pointer of the group.  The consumer then increments
              the segment number for each in-order pointer of that group.<a href="#section-3.9.3-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.9.3-4">Every group of a segmented NcId MUST have either a GroupData with a StartSegmentId, or
            use annotated pointers with SegmentIdAnnotation.<a href="#section-3.9.3-4" class="pilcrow">¶</a></p>
<p id="section-3.9.3-5">A segment number MUST indicate exactly one data item.  That is, the producer
            MUST NOT duplicate the segment number in an object name for different objects.
            The object hash MUST be the same for the same segment number of a name.<a href="#section-3.9.3-5" class="pilcrow">¶</a></p>
<p id="section-3.9.3-6">It is allowed to have multiple manifest entries with the same segment number (see below).<a href="#section-3.9.3-6" class="pilcrow">¶</a></p>
<p id="section-3.9.3-7">While a producer is allowed to mix using GroupData StartSegmentId and SegmentIdAnnotation,
            we in general do not consider that a good idea.  It is up to the manifest producer to ensure
            that every segment may be fetched, and fetch in the right order.
            Segments, when fetched in the <strong>manifest order</strong> reconstruct the original data.<a href="#section-3.9.3-7" class="pilcrow">¶</a></p>
<p id="section-3.9.3-8">Let us make this clear, the original data is constructed by the in-order manifest retrieval, not
          the segment number order.  The consumer should make no assumptions about reconstructing the original
          data and the names of those data elements.<a href="#section-3.9.3-8" class="pilcrow">¶</a></p>
<p id="section-3.9.3-9">A consumer is not required to fetch every segment.  A consumer may fetch segments in any order
            it chooses.  It may skip around or omit segments.<a href="#section-3.9.3-9" class="pilcrow">¶</a></p>
<p id="section-3.9.3-10">It is allowed to have multiple pointers to the same segment number.  This
          can be used for data de-duplication, e.g. multiple occurances of the same binary string within
          the reconstructed data object. If the producer uses this method, then the original data
          cannot be reconstructed by simply fetching the sequence numbers in order.<a href="#section-3.9.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-3.10">
        <h3 id="name-example-structures">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-example-structures" class="section-name selfRef">Example Structures</a>
        </h3>
<section id="section-3.10.1">
          <h4 id="name-leaf-only-data">
<a href="#section-3.10.1" class="section-number selfRef">3.10.1. </a><a href="#name-leaf-only-data" class="section-name selfRef">Leaf-only data</a>
          </h4>
<span id="name-leaf-only-manifest-tree"></span><div id="leafonly">
<figure id="figure-23">
            <div id="section-3.10.1-1.1">
              <div class="alignLeft art-svg artwork" id="section-3.10.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 216 128" width="60%" class="diagram" text-anchor="middle" font-family="monospace" stroke-linecap="round">
                  <path d="M 164,56 L 168,64" fill="none" stroke="black"></path>
                  <path d="M 40,64 L 44,56" fill="none" stroke="black"></path>
                  <path d="M 44,56 L 92,56" fill="none" stroke="black"></path>
                  <path d="M 124,56 L 164,56" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="108" y="20">Root</text>
                    <text x="104" y="36">|</text>
                    <text x="108" y="52">M0</text>
                    <text x="104" y="68">|</text>
                    <text x="36" y="84">M1</text>
                    <text x="108" y="84">M2</text>
                    <text x="180" y="84">M3</text>
                    <text x="32" y="100">/ | \</text>
                    <text x="104" y="100">/ | \</text>
                    <text x="176" y="100">/ | \</text>
                    <text x="108" y="116">D0 D1 D2 D3 D4 D5 D6 D7 D8</text>
                  </g>
                </svg><a href="#section-3.10.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-leaf-only-manifest-tree" class="selfRef">Leaf-only manifest tree</a>
            </figcaption></figure>
</div>
</section>
<section id="section-3.10.2">
          <h4 id="name-linear-chain">
<a href="#section-3.10.2" class="section-number selfRef">3.10.2. </a><a href="#name-linear-chain" class="section-name selfRef">Linear (chain)</a>
          </h4>
<p id="section-3.10.2-1">Of special interest are "skewed trees" where a pointer to a manifest may only appear as
            last pointer of (sub-) manifests. Such a tree becomes a sequential list of manifests
            with a maximum of datapointers per manifest packet. Beside the tree shape we also show
            this data structure in form of packet content where D stands for a data pointer and M is
            the hash of a manifest packet.<a href="#section-3.10.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.10.2-2">
<pre>
Root -&gt; M0 ----&gt; M1 ----&gt; ...
|-&gt;DDDD  |-&gt;DDDD  |- ...
</pre><a href="#section-3.10.2-2" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
</div>
<div id="experiments">
<section id="section-4">
      <h2 id="name-experimenting-with-flic">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-experimenting-with-flic" class="section-name selfRef">Experimenting with FLIC</a>
      </h2>
<p id="section-4-1">FLIC is expected to enable a number of salient experiments in the use of ICN protools by
        applications. These experiments will help not only to inform the desirable structure of ICN
        applications but reflect back to the features included in FLIC to evaluate their usefulness
        to those applications. While many interesting design aspects of FLIC remain to be discovered
        through experience, a number of important questions to be answered through experimentation
        include:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">use for just files or other collections like directories<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">use for particular applications, like streaming media manifests<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">utility of pointer annotations to optimize retrieval<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.4">utility of the encryption options for use by repositories and forwarders<a href="#section-4-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.5">need for application metadata in manifests<a href="#section-4-2.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="Usage">
<section id="section-5">
      <h2 id="name-usage-examples">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-usage-examples" class="section-name selfRef">Usage Examples</a>
      </h2>
<div id="Locating">
<section id="section-5.1">
        <h3 id="name-locating-flic-leaf-and-mani">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-locating-flic-leaf-and-mani" class="section-name selfRef">Locating FLIC leaf and manifest nodes</a>
        </h3>
<p id="section-5.1-1">The names of manifest and data objects are often missing or not unique, unless using
          specific naming conventions. In this example, we show how using manifest locators is used
          to generate Interests. Take for example the figure below where the root manifest is named
          by hash h0. It has nameless children with hashes with hashes h1 ... hN.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span id="name-data-organization"></span><div id="Locating1">
<figure id="figure-24">
          <div class="alignLeft art-text artwork" id="section-5.1-2.1">
<pre>
Objects:
manifest(name=/a/b/c, ptr=h1, ptr=hN)  - has hash h0
nameless(data1)                        - has hash h1
...
nameless(dataN)                        - has hash hN

Query for the manifest:
interest(name=/a/b/c, implicitDigest=h0)
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-data-organization" class="selfRef">Data Organization</a>
          </figcaption></figure>
</div>
<p id="section-5.1-3">After obtaining the manifest, the client fetches the contents. In this first instance,
          the manifest does not provide any Locators data structure, so the client must continue
          using the name it used for the manifest.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<span id="name-data-interests"></span><div id="Locating2">
<figure id="figure-25">
          <div class="alignLeft art-text artwork" id="section-5.1-4.1">
<pre>
interest(name=/a/b/c, implicitDigest=h1)
...
interest(name=/a/b/c, implicitDigest=hN)
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-data-interests" class="selfRef">Data Interests</a>
          </figcaption></figure>
</div>
<p id="section-5.1-5">Using the locator metadata entry, this behavior can be changed:<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<span id="name-using-locators"></span><div id="Locating3">
<figure id="figure-26">
          <div class="alignLeft art-text artwork" id="section-5.1-6.1">
<pre>
Objects:
manifest(name=/a/b/c,
hashgroup(loc=/x/y/z, ptr=h1)
hashgroup(ptr=h2)             - has hash h0
nameless(data1)               - has hash h1
nameless(data2)               - has hash h2

Queries:
interest(name=/a/b/c, implicitDigest=h0)
interest(name=/x/y/z, implicitDigest=h1)
interest(name=/a/b/c, implicitDigest=h2)
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-using-locators" class="selfRef">Using Locators</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="Seeking">
<section id="section-5.2">
        <h3 id="name-seeking">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-seeking" class="section-name selfRef">Seeking</a>
        </h3>
<p id="section-5.2-1">Fast seeking (without having to sequentially fetch all content) works by skipping over
          entries for which we know their size. The following expression shows how to compute the
          byte offset of the data pointed at by pointer <code>P_i</code>, call it <code>offset_i</code>. In
          this formula, let <code>P_i.size</code> represent the Size value of the <em>i</em>-th
          pointer.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-5.2-2">
<pre>offset_i = \sum_{k=1}^{i-1} &amp;gt; P_k.size</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3">With this offset, seeking is done as follows:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<span id="name-seeking-algorithm"></span><div id="Seeking1">
<figure id="figure-27">
          <div class="lang-pseudocode sourcecode" id="section-5.2-4.1">
<pre>
Input: seek_pos P, a FLIC manifest with a hash group having N entries
Output: pointer index i and byte offset o, or out-of-range error
Algorithm:
offset = 0
for i in 1..N do
   if (P &amp;gt; offset + P_i.size)
      return (i, P - offset)
   offset += P_i.size
return out-of-range

</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-seeking-algorithm" class="selfRef">Seeking Algorithm</a>
          </figcaption></figure>
</div>
<p id="section-5.2-5">Seeking in a BlockHashGroup is different since offsets can be quickly computed. This is
          because the size of each pointer P_i except the last is equal to the SizePerPtr value. For
          a BlockHashGroup with N pointers, OverallByteCount D, and SizePerPointer L, the size of
          P_N is equal to the following:<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-6">
<pre>
D - ((N - 1) * L)
</pre><a href="#section-5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2-7">In a BlockHashGroup with k pointers, the size of P_k is equal to:<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-8">
<pre>
D - L * (k - 1)
</pre><a href="#section-5.2-8" class="pilcrow">¶</a>
</div>
<p id="section-5.2-9">Using these, the seeking algorithm can be thus simplified to the following:<a href="#section-5.2-9" class="pilcrow">¶</a></p>
<span id="name-seeking-algorithm-2"></span><div id="Seeking2">
<figure id="figure-28">
          <div class="lang-pseudocode sourcecode" id="section-5.2-10.1">
<pre>
Input: seek_pos P, a FLIC manifest with a hash group having
                   OverallByteCount S and SizePerPointer L.
Output: pointer index i and byte offset o, or out-of-range error
Algorithm:
if (P &gt; S)
   return out-of-range
i = floor(P / L)
if (i &gt; N)
   return out-of-range # bad FLIC encoding
o = P mod L
return (i, o)
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-seeking-algorithm-2" class="selfRef">Seeking Algorithm</a>
          </figcaption></figure>
</div>
<aside id="section-5.2-11">
          <p id="section-5.2-11.1"><strong>Note</strong>: In both cases, if the pointer at position i is a manifest
            pointer, this algorithm has to be called once more, seeking to seek_pos o inside that
            manifest.<a href="#section-5.2-11.1" class="pilcrow">¶</a></p>
</aside>
</section>
</div>
<div id="dedup">
<section id="section-5.3">
        <h3 id="name-block-level-de-duplication">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-block-level-de-duplication" class="section-name selfRef">Block-level de-duplication</a>
        </h3>
<p id="section-5.3-1">Consider a huge file, e.g. an ISO image of a DVD or program in binary be patched. In this
          case, all existing encoded ICN chunks can remain in the repository while only the chunks
          for the patch itself is added to a new manifest data structure, as is shown in the diagram
          below. For example, the <span><a href="#venti" class="internal xref">venti archival file system of Plan9</a> [<a href="#venti" class="cite xref">venti</a>]</span>
          uses this technique.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<span id="name-de-duplications"></span><div id="dedup1">
<figure id="figure-29">
          <div id="section-5.3-2.1">
            <div class="alignLeft art-svg artwork" id="section-5.3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="80%" viewBox="0 0 456 96" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 160,16 L 176,16" fill="none" stroke="black"></path>
                <path d="M 272,16 L 288,16" fill="none" stroke="black"></path>
                <path d="M 160,32 L 176,32" fill="none" stroke="black"></path>
                <path d="M 272,32 L 288,32" fill="none" stroke="black"></path>
                <path d="M 272,48 L 288,48" fill="none" stroke="black"></path>
                <path d="M 160,64 L 176,64" fill="none" stroke="black"></path>
                <path d="M 160,80 L 176,80" fill="none" stroke="black"></path>
                <path d="M 272,80 L 288,80" fill="none" stroke="black"></path>
                <path d="M 80,32 L 104,80" fill="none" stroke="black"></path>
                <path d="M 360,80 L 384,32" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="280,80 268,74.4 268,85.6" fill="black" transform="rotate(180,272,80)"></polygon>
                <polygon class="arrowhead" points="280,48 268,42.4 268,53.6" fill="black" transform="rotate(180,272,48)"></polygon>
                <polygon class="arrowhead" points="280,32 268,26.4 268,37.6" fill="black" transform="rotate(180,272,32)"></polygon>
                <polygon class="arrowhead" points="280,16 268,10.4 268,21.6" fill="black" transform="rotate(180,272,16)"></polygon>
                <polygon class="arrowhead" points="184,80 172,74.4 172,85.6" fill="black" transform="rotate(0,176,80)"></polygon>
                <polygon class="arrowhead" points="184,64 172,58.4 172,69.6" fill="black" transform="rotate(0,176,64)"></polygon>
                <polygon class="arrowhead" points="184,32 172,26.4 172,37.6" fill="black" transform="rotate(0,176,32)"></polygon>
                <polygon class="arrowhead" points="184,16 172,10.4 172,21.6" fill="black" transform="rotate(0,176,16)"></polygon>
                <g class="text">
                  <text x="44" y="20">old_mfst -</text>
                  <text x="124" y="20">- &gt; h1</text>
                  <text x="220" y="20">oldData1</text>
                  <text x="324" y="20">h1 &lt; -</text>
                  <text x="368" y="20">-</text>
                  <text x="420" y="20">new_mfst</text>
                  <text x="124" y="36">- &gt; h2</text>
                  <text x="220" y="36">oldData2</text>
                  <text x="324" y="36">h2 &lt; -</text>
                  <text x="368" y="36">-</text>
                  <text x="220" y="52">replace3</text>
                  <text x="324" y="52">h5 &lt; -</text>
                  <text x="368" y="52">-</text>
                  <text x="124" y="68">- &gt; h3</text>
                  <text x="220" y="68">oldData3</text>
                  <text x="132" y="84">&gt; h4</text>
                  <text x="220" y="84">oldData4</text>
                  <text x="324" y="84">h4 &lt; -</text>
                </g>
              </svg><a href="#section-5.3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-de-duplications" class="selfRef">De-duplications</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="GrowingCollections">
<section id="section-5.4">
        <h3 id="name-growing-icn-collections">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-growing-icn-collections" class="section-name selfRef">Growing ICN collections</a>
        </h3>
<p id="section-5.4-1">A log file, for example, grows over time.  Instead of having to re-                     FLIC the grown file it suffices to construct a new manifest with a                     manifest pointer to the old root manifest plus the sequence of data                     hash pointers for the new data (or additional sub-manifests if                     necessary).<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<aside id="section-5.4-2">
          <p id="section-5.4-2.1"><strong>Note</strong> that this tree will not be skewed (anymore).<a href="#section-5.4-2.1" class="pilcrow">¶</a></p>
</aside>
<span id="name-growing-a-collection"></span><div id="Growing">
<figure id="figure-30">
          <div class="alignCenter art-text artwork" id="section-5.4-3.1">
<pre>
old data &lt; -  -  -  mfst_old &lt;-- h_old -  - mfst_new
                                            /
new data1 &lt;-- h_1 -  -  -  -  -  -  -  -  -/
new data2                                 /
...                                      /
new dataN &lt;-- h_N -  -  -  -  -  -  -  -/
</pre>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-growing-a-collection" class="selfRef">Growing A Collection</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="Republishing">
<section id="section-5.5">
        <h3 id="name-re-publishing-a-flic-under-">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-re-publishing-a-flic-under-" class="section-name selfRef">Re-publishing a FLIC under a new name</a>
        </h3>
<p id="section-5.5-1">There are several use cases for republishing a collection under a new namespace, or
          having one collection exist under several namespaces:<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-2.1">It can happen that a publisher's namespace is part of a service provider's prefix.
            When switching provider, the publisher may want to republish the old data under a new
            name.<a href="#section-5.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.2">A publishes wishes to distribute its content to several repositories and would like a
            result to be delivered from the repository for consumers who have good connectivity to
            that repository. For example, the publisher /alpha wishes to place content at /beta and
            /gamma, but routing only to /alpha would not send a request to either /beta or /gamma.
            The operators of of /beta and /gamma could create a named and signed version of the root
            manifest with appropriate keys (or delegate that to /alpha) so the results are always
            delivered by the corresponding repository without having to change the bulk of the
            manifest tree.<a href="#section-5.5-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.5-3">This can easily be achieved with a single nameless root manifest for the large FLIC plus
          arbitrarily many per-name manifests (which are signed by whomever wants to publish this
          data):<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<span id="name-relocating-a-collection"></span><div id="Relocating">
<figure id="figure-31">
          <div class="alignLeft art-text artwork" id="section-5.5-4.1">
<pre>

data &lt; - nameless_mfst() &lt;-- h  &lt; - mfst(/com/example/east/the/flic)
                                &lt; - mfst(/com/example/west/old/the/flic)
                                &lt; - mfst(/internet/archive/flic234)
</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-relocating-a-collection" class="selfRef">Relocating A Collection</a>
          </figcaption></figure>
</div>
<aside id="section-5.5-5">
          <p id="section-5.5-5.1">Note that the hash computation (of h) only requires reading the nameless root manifest,
            not the entire FLIC.<a href="#section-5.5-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-5.5-6">This example points out the problem of HashGroups having their own locator metadata
          elements: A retriever would be urged to follow these hints which are "hardcoded" deep
          inside the FLIC but might have become outdated. We therefore recommend to name FLIC
          manifests only at the highest level (where these names have no locator function). Child
          nodes in a FLIC manifest should not be named as these names serve no purpose except
          retrieving a sub-tree's manifest by name, if would be required.<a href="#section-5.5-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">FLIC adds two values to existing registries and defines two new registry in the 
        "Content-Centric Networking (CCNx)" group.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The FLIC registries follow the CCNx convention of reserving the namespace 0x1000 - 0x1FFF
          for experimental use.  It also uses the T_ORG (0x0FFF) definition for organizational
          (vendor) extensions in the <code>NodeData</code> and <code>GroupData</code> fields.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">IANA will assign value "0x0004" to "T_MANIFEST_ID" in the "CCNx Name Segment Types" registry.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">IANA will assign value "0x0003" to "T_PAYLOADTYPE_MANIFEST" in the "CCNx Payload Types" registry.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">IANA will add the following new registry to the 
        "Content-Centric Networking (CCNx)" registry group at https://www.iana.org/assignments/ccnx):<a href="#section-6-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6-6.1">Registry Name: CCNx Manifest Type<a href="#section-6-6.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-6.2">Registration Procedure: Specification Required<a href="#section-6-6.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-6.3">This defines the TLV type of a Manifest inside a CCNx Payload.<a href="#section-6-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-manifest-type"></span><table class="left" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-manifest-type" class="selfRef">Manifest Type</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-center" rowspan="1" colspan="1">Name</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0000</td>
            <td class="text-center" rowspan="1" colspan="1">T_FLIC_MANIFEST</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0001-0x0FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x1000-0x1FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Reserved for experimental use</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x2000-0xFFFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<p id="section-6-8">IANA will add the following new registry and sub-registries to the 
        "Content-Centric Networking (CCNx)" registry group at https://www.iana.org/assignments/ccnx):<a href="#section-6-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6-9.1">Registry Name: FLIC Manifest<a href="#section-6-9.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-9.2">Registration Procedure: Specification Required<a href="#section-6-9.2" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-flic-manifest"></span><table class="left" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-flic-manifest" class="selfRef">FLIC Manifest</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-center" rowspan="1" colspan="1">Name</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0000</td>
            <td class="text-center" rowspan="1" colspan="1">T_SECURITY_CTX</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0001</td>
            <td class="text-center" rowspan="1" colspan="1">T_NODE</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0002</td>
            <td class="text-center" rowspan="1" colspan="1">T_ENCRYPTED_NODE</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0003</td>
            <td class="text-center" rowspan="1" colspan="1">T_AUTH_TAG</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0004-0x0FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x1000-0x1FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Reserved for experimental use</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x2000-0xFFFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<ul class="compact">
<li class="compact" id="section-6-11.1">Sub-registry Name: FLIC Manifest (SecurityCtx)<a href="#section-6-11.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-11.2">Registration Procedure: Specification Required<a href="#section-6-11.2" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-flic-manifest-securityctx"></span><table class="left" id="table-3">
        <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-flic-manifest-securityctx" class="selfRef">FLIC Manifest (SecurityCtx)</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-center" rowspan="1" colspan="1">Name</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0000</td>
            <td class="text-center" rowspan="1" colspan="1">T_AEAD_CTX</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0001</td>
            <td class="text-center" rowspan="1" colspan="1">T_RSAOAEP_CTX</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0002-0x0FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x1000-0x1FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Reserved for experimental use</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x2000-0xFFFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<ul class="compact">
<li class="compact" id="section-6-13.1">Sub-registry Name: FLIC Manifest (Node)<a href="#section-6-13.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-13.2">Registration Procedure: Specification Required<a href="#section-6-13.2" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-flic-manifest-node"></span><table class="left" id="table-4">
        <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-flic-manifest-node" class="selfRef">FLIC Manifest (Node)</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-center" rowspan="1" colspan="1">Name</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0000</td>
            <td class="text-center" rowspan="1" colspan="1">T_NODE_DATA</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0001</td>
            <td class="text-center" rowspan="1" colspan="1">T_HASH_GROUP</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0002</td>
            <td class="text-center" rowspan="1" colspan="1">T_SUBTREE_SIZE</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0003</td>
            <td class="text-center" rowspan="1" colspan="1">T_SUBTREE_DIGEST</td>
            <td class="text-center" rowspan="1" colspan="1">Value is in CCNx Hash Format <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0004</td>
            <td class="text-center" rowspan="1" colspan="1">T_NCDEF</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0005</td>
            <td class="text-center" rowspan="1" colspan="1">T_NCID</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0006</td>
            <td class="text-center" rowspan="1" colspan="1">T_LOCATORS</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0007</td>
            <td class="text-center" rowspan="1" colspan="1">T_PTRS</td>
            <td class="text-center" rowspan="1" colspan="1">Value is array of CCNx Hash Format <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0008</td>
            <td class="text-center" rowspan="1" colspan="1">T_ANNOTATED_PTRS</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0009</td>
            <td class="text-center" rowspan="1" colspan="1">T_PTR_BLOCK</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000A</td>
            <td class="text-center" rowspan="1" colspan="1">T_PTR</td>
            <td class="text-center" rowspan="1" colspan="1">Value is in CCNx Hash Format <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000B</td>
            <td class="text-center" rowspan="1" colspan="1">T_GROUP_DATA</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000C-0x000F</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0010</td>
            <td class="text-center" rowspan="1" colspan="1">T_HashSchema</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0011</td>
            <td class="text-center" rowspan="1" colspan="1">T_PrefixSchema</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0012</td>
            <td class="text-center" rowspan="1" colspan="1">T_SegmentedSchema</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0013-0x0FFE</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0FFF</td>
            <td class="text-center" rowspan="1" colspan="1">T_ORG</td>
            <td class="text-center" rowspan="1" colspan="1">
              <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x1000-0x1FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Reserved for experimental use</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x2000-0xFFFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<ul class="compact">
<li class="compact" id="section-6-15.1">Sub-registry Name: FLIC Manifest (NcSchema)<a href="#section-6-15.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-15.2">Registration Procedure: Specification Required<a href="#section-6-15.2" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-flic-manifest-ncschema"></span><table class="left" id="table-5">
        <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-flic-manifest-ncschema" class="selfRef">FLIC Manifest (NcSchema)</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-center" rowspan="1" colspan="1">Name</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0000</td>
            <td class="text-center" rowspan="1" colspan="1">T_NAME</td>
            <td class="text-center" rowspan="1" colspan="1">
              <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0001</td>
            <td class="text-center" rowspan="1" colspan="1">T_PROTOCOL_FLAGS</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0002</td>
            <td class="text-center" rowspan="1" colspan="1">T_SUFFIX_TYPE</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0003-0x0005</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0006</td>
            <td class="text-center" rowspan="1" colspan="1">T_LOCATORS</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0007-0x000C</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000D</td>
            <td class="text-center" rowspan="1" colspan="1">T_LINK</td>
            <td class="text-center" rowspan="1" colspan="1">Value is a Link <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.4" class="relref">Section 3.3.4</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000E-0x0FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x1000-0x1FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Reserved for experimental use</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x2000-0xFFFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<ul class="compact">
<li class="compact" id="section-6-17.1">Sub-registry Name: FLIC Manifest (Group Data)<a href="#section-6-17.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-17.2">Registration Procedure: Expert Review<a href="#section-6-17.2" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-flic-manifest-group-data"></span><table class="left" id="table-6">
        <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-flic-manifest-group-data" class="selfRef">FLIC Manifest (Group Data)</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-center" rowspan="1" colspan="1">Name</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0000</td>
            <td class="text-center" rowspan="1" colspan="1">T_LEAF_SIZE</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0001</td>
            <td class="text-center" rowspan="1" colspan="1">T_LEAF_DIGEST</td>
            <td class="text-center" rowspan="1" colspan="1">Value is a CCNx Hash Format <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0002</td>
            <td class="text-center" rowspan="1" colspan="1">T_SUBTREE_SIZE</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0003</td>
            <td class="text-center" rowspan="1" colspan="1">T_SUBTREE_DIGEST</td>
            <td class="text-center" rowspan="1" colspan="1">Value is in CCNx Hash Format <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0004</td>
            <td class="text-center" rowspan="1" colspan="1">T_START_SEGMENT_ID</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0005-0x0FFE</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0FFF</td>
            <td class="text-center" rowspan="1" colspan="1">T_ORG</td>
            <td class="text-center" rowspan="1" colspan="1">
              <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x1000-0x1FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Reserved for experimental use</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x2000-0xFFFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<ul class="compact">
<li class="compact" id="section-6-19.1">Sub-registry Name: FLIC Manifest (SecurityCtx Parameters)<a href="#section-6-19.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-19.2">Registration Procedure: Expert Review<a href="#section-6-19.2" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-flic-manifest-securityctx-p"></span><table class="left" id="table-7">
        <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-flic-manifest-securityctx-p" class="selfRef">FLIC Manifest (SecurityCtx Parameters)</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-center" rowspan="1" colspan="1">Name</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0000</td>
            <td class="text-center" rowspan="1" colspan="1">T_KEYNUM</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0001</td>
            <td class="text-center" rowspan="1" colspan="1">T_NONCE</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0002</td>
            <td class="text-center" rowspan="1" colspan="1">T_AEADMode</td>
            <td class="text-center" rowspan="1" colspan="1">Value a per IANA "AEAD Algorithms" <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span> </td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0003</td>
            <td class="text-center" rowspan="1" colspan="1">T_HASH_ALG</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0004</td>
            <td class="text-center" rowspan="1" colspan="1">T_WRAPPED_KEY</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0005</td>
            <td class="text-center" rowspan="1" colspan="1">T_KDF_DATA</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0006</td>
            <td class="text-center" rowspan="1" colspan="1">T_KDF_ALG</td>
            <td class="text-center" rowspan="1" colspan="1">Value as per IANA "HPKE KDF Identifiers" <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0007</td>
            <td class="text-center" rowspan="1" colspan="1">T_KDF_INFO</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0008</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0009</td>
            <td class="text-center" rowspan="1" colspan="1">T_KEYID</td>
            <td class="text-center" rowspan="1" colspan="1">As per <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.6.4.1.4" class="relref">Section 3.6.4.1.4</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000A-0x000D</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000E</td>
            <td class="text-center" rowspan="1" colspan="1">T_KEYLINK</td>
            <td class="text-center" rowspan="1" colspan="1">As per <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.6.4.1.4" class="relref">Section 3.6.4.1.4</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000F-0x0FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x1000-0x1FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Reserved for experimental use</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x2000-0xFFFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<ul class="compact">
<li class="compact" id="section-6-21.1">Sub-registry Name: FLIC Manifest (Annotation)<a href="#section-6-21.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-6-21.2">Registration Procedure: Expert Review<a href="#section-6-21.2" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-flic-manifest-annotation"></span><table class="left" id="table-8">
        <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-flic-manifest-annotation" class="selfRef">FLIC Manifest (Annotation)</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-center" rowspan="1" colspan="1">Name</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0000</td>
            <td class="text-center" rowspan="1" colspan="1">T_ANN_SIZE</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0001</td>
            <td class="text-center" rowspan="1" colspan="1">T_ANN_SEGMENT_ID</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0003-0x000C</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000D</td>
            <td class="text-center" rowspan="1" colspan="1">T_LINK</td>
            <td class="text-center" rowspan="1" colspan="1">Value is a Link <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.4" class="relref">Section 3.3.4</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x000E-0x0FFE</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x0FFF</td>
            <td class="text-center" rowspan="1" colspan="1">T_ORG</td>
            <td class="text-center" rowspan="1" colspan="1">
              <span><a href="https://rfc-editor.org/rfc/rfc8609#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x1000-0x1FFF</td>
            <td class="text-center" rowspan="1" colspan="1">Reserved for experimental use</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">0x2000-0xFFFF</td>
            <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="Security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">TODO Need a discussion on:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">signing and hash chaining security. (<strong>Note: Did I cover this adequately
            below?</strong>)<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">republishing under a new namespace. (<strong>Note: need help here - is this to reinforce
            that you can re-publish application data by creating a new root Manifest and signing
            that, requiring only one signature to change?</strong>)<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.3">encryption mechanisms. (<strong>Note: did I cover this adequately below?</strong>)<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.4">encryption key distribution mechanisms.(<strong>Note: not sure what needs to be said
            here</strong>)<a href="#section-7-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.5">discussion of privacy, leaking of linkability information - <strong>could really use
            some help here</strong>.<a href="#section-7-2.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-3"><strong>Anything else?????</strong>.<a href="#section-7-3" class="pilcrow">¶</a></p>
<section id="section-7.1">
        <h3 id="name-integrity-and-origin-authen">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-integrity-and-origin-authen" class="section-name selfRef">Integrity and Origin Authentication of FLIC Manifests</a>
        </h3>
<p id="section-7.1-1">A FLIC Manifest is used to describe how to form Interests to access large CCNx or NDN
          application data. The Manifest is itself either an individual content object, or a tree of
          content objects linked together via the corresponding content hashes. The NDN and CCnx
          protocol architectures directly provide both individual object integrity (using
          cryptographically strong hashes) and data origin authentication (using signatures). The
          protocol specifications, <span>[<a href="#NDN" class="cite xref">NDN</a>]</span> and <span><a href="#RFC8609" class="internal xref">CCNx</a> [<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>
          respectively, provide the protocol machinery and keying to support strong integrity and
          authentication. Therefore, FLIC utilizes the existing protocol specifications for these
          functions, rather than providing its own. There are a few subtle differences in the
          handling of signatures and keys in NDN and CCNx worth recapitulating here:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">NDN in general adds a signature to every individual data packet rather than
            aggregating signatures via some object-level scheme. When employing FLIC Manifests to
            multi-packet NDN objects, it is expected that the individual packet signatures would be
            elided and the signture on the Manifest used instead.<a href="#section-7.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-2.2">In contrast, CCNx is biased to have primitive objects or pieces thereof be "nameless"
            in the sense they are identified only by their hashes rather than each having a name
            directly bound to the content through an individual signature. Therefore, CCNx depends
            heavily on FLIC (or an alternative method) to provide the name and the signed binding of
            the name to the content described in the Manifest<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.1-3">A FLIC Manifest therefore gets integrity of its individual pieces through the existing
          secure hashing procedures of the underlying protocols. Origin authentication of the entire
          Manifest is achieved through hash chaining and applying a signature <strong>only</strong>
          to the root Manifest of a manifest tree. It is important to note that the Name of the
          Manifest, which is what the signature is bound to, need not bear any particular
          relationship to the names of the application objects pointed to in the Manifest via Name
          Constructors. This has a number of important benefits described in <a href="#nameconstructors" class="auto internal xref">Section 3.3</a>.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-7.2">
        <h3 id="name-confidentiality-of-manifest">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-confidentiality-of-manifest" class="section-name selfRef">Confidentiality of Manifest Data</a>
        </h3>
<p id="section-7.2-1">ICN protocol architectures like CCNx and NDN, while providing integrity and origin
          authentication as described above, leaves confidentiality issues entirely in the domain of
          the ICN application. Therefore, since FLIC is an application-level construct in both NDN
          and CCNx, it is incumbent on this specification for FLIC to provide the desired
          confidentiality properties using encryption. One could leave the specification of Manifest
          encryption entirely in the hands of the individual application utilizing FLIC, but this
          would be undesirable for a number of reasons:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">The sensitivity of the information in a Manifest may be different from the sensitivity
            of the application data it describes. In some cases, it may not be necessary to encrypt
            manifests, or to encrypt them with a different keying scheme from that used for the
            application data<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-2.2">One of the major capabilities enabled by FLIC is to allow repositories or forwarding
            caches to operate on Manifests (see in particular <a href="#metadata" class="auto internal xref">Section 3.4</a>). In order
            to allow such intermediaries to interpret manifests without revealing the underlying
            application data, separate encryption and keying is necessary<a href="#section-7.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-2.3">A strong design goal of FLIC is <em>universality</em> such that it can be used
            transparently by many different ICN applications. This argues that FLIC should have a
            set of common encryption and keying capabilities that can be delegated to library code
            and not have to be re-worked by each individual application (see <a href="#libraries" class="auto internal xref">Section 2, Paragraph 11</a>)<a href="#section-7.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-3">Therefore, this specification directly specifies two encryption encapsulations and
          associated links to key management, as described in <a href="#encryption" class="auto internal xref">Section 3.8</a>. As more
          experience is gained with various use cases, additional encryption capabilities may be
          needed and hence we expect the encryption aspects of this specification to evolve over
          time.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
<section id="section-7.3">
        <h3 id="name-privacy-of-names-and-linkab">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-privacy-of-names-and-linkab" class="section-name selfRef">Privacy of names and linkability of access patterns</a>
        </h3>
<p id="section-7.3-1">What to say here, if anything?<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-7.4">
        <h3 id="name-symmetric-key-lifespan-scop">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-symmetric-key-lifespan-scop" class="section-name selfRef">Symmetric key lifespan, scope, and use</a>
        </h3>
<p id="section-7.4-1">The lifespan and scope of symmetric keys, as identified by a <code>KeyNum</code>, is
        different between an <code>AeadCtx</code> and an <code>RsaOaepCtx</code>.  In the <code>AeadCtx</code>
        case, the lifespan and scope is agreed to by the publisher and consumer out of band.
        In the <code>RsaOaepCtx</code> the lifespan and scope is implicitly the curent manifest.
        We will discuss the <code>RsaOaepCtx</code> case first, as it is the simpler of the two.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">For <code>RsaOaepCtx</code>, the first manifest in the tree to use RSA-OAEP must include the
        wrapped key.  The <code>KeyNum</code> is purely local within the manifest.  The only requirement
        is that the <code>KeyNum</code> have a one-to-one assiciation with a specific wrapped key within
        the manifest.  That is, a publisher must not reuse a <code>KeyNum</code> within a single manifest tree
        for two different AES key and salt combinations.  The key lifespan is strictly the 
        <code>ExpiryTime</code> of the manifest and the scope is that single manifest.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">A publisher should use new symmetric keys for each manifest encrypted with RSA-OAEP.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">For <code>AeadCtx</code>, a publisher and one or more consumers agree on a shared
        symmetric key out-of-band and share it via some means.  The publisher and consumer must
        agree on both the lifespan of the key and its scope.  The lifespan of such a key should be
        no shorter than the greatest <code>ExpiryTime</code> of a manifest published with the key.
        The scope of use should be, at minimum, manifests signed by the publisher's <code>KeyId</code>.
        The publisher and consumer may also add name prefix limitations to a symmetric key's scope.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<p id="section-7.4-5">Because there is no requirement that an <code>AeadCtx</code> <code>KeyNum</code> be globally unique, one should
        store them based on their scopes, such as <code>(Publisher KeyId, KeyNum)</code> or
        <code>(Publisher KeyId, Name Prefix, KeyNum)</code>.<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">If a publisher will use a single AES key across multiple manifests, it must ensure that
          it never re-uses the same nonce.<a href="#section-7.4-6" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3310">[RFC3310]</dt>
        <dd>
<span class="refAuthor">Niemi, A.</span>, <span class="refAuthor">Arkko, J.</span>, and <span class="refAuthor">V. Torvinen</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP) Digest Authentication Using Authentication and Key Agreement (AKA)"</span>, <span class="seriesInfo">RFC 3310</span>, <span class="seriesInfo">DOI 10.17487/RFC3310</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3310">https://www.rfc-editor.org/info/rfc3310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5116">https://www.rfc-editor.org/info/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5288">[RFC5288]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span>, <span class="refAuthor">Choudhury, A.</span>, and <span class="refAuthor">D. McGrew</span>, <span class="refTitle">"AES Galois Counter Mode (GCM) Cipher Suites for TLS"</span>, <span class="seriesInfo">RFC 5288</span>, <span class="seriesInfo">DOI 10.17487/RFC5288</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5288">https://www.rfc-editor.org/info/rfc5288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5990">[RFC5990]</dt>
        <dd>
<span class="refAuthor">Randall, J.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Brainard, J.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Use of the RSA-KEM Key Transport Algorithm in the Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 5990</span>, <span class="seriesInfo">DOI 10.17487/RFC5990</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5990">https://www.rfc-editor.org/info/rfc5990</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6655">[RFC6655]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span> and <span class="refAuthor">D. Bailey</span>, <span class="refTitle">"AES-CCM Cipher Suites for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6655</span>, <span class="seriesInfo">DOI 10.17487/RFC6655</span>, <time datetime="2012-07" class="refDate">July 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6655">https://www.rfc-editor.org/info/rfc6655</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8569">[RFC8569]</dt>
        <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refAuthor">Solis, I.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Content-Centric Networking (CCNx) Semantics"</span>, <span class="seriesInfo">RFC 8569</span>, <span class="seriesInfo">DOI 10.17487/RFC8569</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8569">https://www.rfc-editor.org/info/rfc8569</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8609">[RFC8609]</dt>
        <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refAuthor">Solis, I.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Content-Centric Networking (CCNx) Messages in TLV Format"</span>, <span class="seriesInfo">RFC 8609</span>, <span class="seriesInfo">DOI 10.17487/RFC8609</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8609">https://www.rfc-editor.org/info/rfc8609</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
      <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9180">https://www.rfc-editor.org/info/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AESGCM">[AESGCM]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"</span>, <span class="seriesInfo">National Institute of Standards and Technology SP 800-38D</span>, <time datetime="2007" class="refDate">2007</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-38D">https://doi.org/10.6028/NIST.SP.800-38D</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FLICImplementation">[FLICImplementation]</dt>
        <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refTitle">"FLIC Implementation in Python"</span>, <span>various</span>, <span>&lt;<a href="https://github.com/mmosko/ccnpy">https://github.com/mmosko/ccnpy</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.wood-icnrg-ccnxkeyexchange">[I-D.wood-icnrg-ccnxkeyexchange]</dt>
        <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refAuthor">Uzun, E.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"CCNx Key Exchange Protocol Version 1.0"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-wood-icnrg-ccnxkeyexchange-02</span>, <time datetime="2017-07-06" class="refDate">6 July 2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-wood-icnrg-ccnxkeyexchange-02">https://datatracker.ietf.org/doc/html/draft-wood-icnrg-ccnxkeyexchange-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NDN">[NDN]</dt>
        <dd>
<span class="refTitle">"Named Data Networking"</span>, <span>various</span>, <span>&lt;<a href="https://named-data.net/project/execsummary/">https://named-data.net/project/execsummary/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NDNTLV">[NDNTLV]</dt>
        <dd>
<span class="refTitle">"NDN Packet Format Specification."</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="http://named-data.net/doc/ndn-tlv/">http://named-data.net/doc/ndn-tlv/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ProjectOrigin">[ProjectOrigin]</dt>
        <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refTitle">"Peer-to-Peer Sharing with CCNx 1.0"</span>, <time datetime="2014" class="refDate">2014</time>, <span>&lt;<a href="https://github.com/PARC/CCNxReports/blob/master/SelectedTopics/p2pshare.pdf">https://github.com/PARC/CCNxReports/blob/master/SelectedTopics/p2pshare.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="repository">[repository]</dt>
        <dd>
<span class="refTitle">"Repo Protocol Specification"</span>, <span>Various</span>, <span>&lt;<a href="https://redmine.named-data.net/projects/repo-ng/wiki/Repo_Protocol_Specification">https://redmine.named-data.net/projects/repo-ng/wiki/Repo_Protocol_Specification</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7927">[RFC7927]</dt>
        <dd>
<span class="refAuthor">Kutscher, D., Ed.</span>, <span class="refAuthor">Eum, S.</span>, <span class="refAuthor">Pentikousis, K.</span>, <span class="refAuthor">Psaras, I.</span>, <span class="refAuthor">Corujo, D.</span>, <span class="refAuthor">Saucez, D.</span>, <span class="refAuthor">Schmidt, T.</span>, and <span class="refAuthor">M. Waehlisch</span>, <span class="refTitle">"Information-Centric Networking (ICN) Research Challenges"</span>, <span class="seriesInfo">RFC 7927</span>, <span class="seriesInfo">DOI 10.17487/RFC7927</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7927">https://www.rfc-editor.org/info/rfc7927</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RSAKEM">[RSAKEM]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, <span class="refAuthor">Davis, R.</span>, and <span class="refAuthor">S. Simon</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Using Integer Factorization Cryptography"</span>, <span class="seriesInfo">National Institute of Standards and Technology SP 800-56B Rev. 2</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-56Br2">https://doi.org/10.6028/NIST.SP.800-56Br2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHS">[SHS]</dt>
        <dd>
<span class="refAuthor">Technology, N. I. O. S. A.</span>, <span class="refTitle">"Secure Hash Standard, United States of American, National Institute of Science and Technology, Federal Information Processing Standard (FIPS) 180-4"</span>, <span class="seriesInfo">National Institute of Standards and Technology SP 180-4</span>, <time datetime="2012" class="refDate">2012</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/fips/fips180-4/%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fips180-4_final.pdf">https://csrc.nist.gov/publications/fips/fips180-4/               fips180-4_final.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="venti">[venti]</dt>
      <dd>
<span class="refTitle">"Venti: a new approach to archival storage"</span>, <span class="seriesInfo">Bell Labs Document Archive /sts/doc</span>, <time datetime="2002" class="refDate">2002</time>, <span>&lt;<a href="http://doc.cat-v.org/plan_9/4th_edition/papers/venti/">http://doc.cat-v.org/plan_9/4th_edition/papers/venti/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="building-trees">
<section id="appendix-A">
      <h2 id="name-building-trees">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-building-trees" class="section-name selfRef">Building Trees</a>
      </h2>
<p id="appendix-A-1">This appendix describes one method to build trees. It constructs a pre-order tree in a
        single pass of the application data, going from the tail to the beginning. This allows us to
        work up the right side of the tree in a single pass, then work down each left branch until
        we exhaust the data. Using the reverse-order traversal, we create the right-most-child
        manifest, then its parent, then the indirect pointers of that parent, then the parent's
        direct pointers,then the parent of the parent (repeating). This process uses recursion, as
        it is the clearest way to show the code. A more optimized approach could do it in a true
        single pass.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Because we're building from the bottom up, we use the term 'level' to be the distance from
        the right-most child up. Level 0 is the bottom-most level of the tree, such as where node 7
        is:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div class="alignCenter art-text artwork" id="appendix-A-3">
<pre>
      1
  2      3
4  5    6  7
preorder: 1 2 4 5 3 6 7
reverse:  7 6 3 5 4 2 1
</pre><a href="#appendix-A-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A-4">The Python-like pseudocode build_tree(data, n, k, m) algorithm creates a tree of n data
        objects. The data[] array is an array of Content Objects that hold application payload; the
        application data has already been packetized into n Content Object packets.An interior
        manifest node has k direct pointers and m indirect pointers.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<div class="lang-python sourcecode" id="appendix-A-5">
<pre>
build_tree(data[0..n-1], n, k, m):
  # data is an array of Content Objects (Data in NDN) with app data.
  # n is the number of data items
  # k is the number of direct pointers per internal node
  # m is the number of indirect pointers per internal node

  segment = namedtuple('Segment', 'head tail')(0, n)
  level = 0

  # This bootstraps the process by creating the right most child
  # manifest. A leaf manifest has no indirect pointers, so k+m
  # are direct pointers
  root = leaf_manifest(data, segment, k + m)

  # Keep building subtrees until we're out of direct pointers
  while not segment.empty():
    level += 1
    root = bottom_up_preorder(data, segment, level, k, m, root)

  return root
</pre><a href="#appendix-A-5" class="pilcrow">¶</a>
</div>
<div class="lang-python sourcecode" id="appendix-A-6">
<pre>
bottom_up_preorder(data, segment, level, k, m, right_most_child=None):
  manifest = None
  if level == 0:
    assert right_most_child is None
    # build a leaf manifest with only direct pointers
    manifest = leaf_manifest(data, segment, k + m)
  else:
    # If the number of remaining direct pointers will fit
    # in a leaf node, make one of those. Otherwise, we need to be
    # an interior node
  if right_most_child is None and segment.length() &amp;lt;= k + m:
    manifest = leaf_manifest(data, segment, k+m)
  else:
    manifest = interior_manifest(data, segment, level,
                                 k, m, right_most_child)
  return manifest
</pre><a href="#appendix-A-6" class="pilcrow">¶</a>
</div>
<div class="lang-python sourcecode" id="appendix-A-7">
<pre>
leaf_manifest(data, segment, count):
  # At most count items, but never go before the head
  start = max(segment.head(), segment.tail() - count)
  manifest = Manifest(data[start:segment.tail])
  segment.tail -= segment.tail() - start
  return manifest
</pre><a href="#appendix-A-7" class="pilcrow">¶</a>
</div>
<div class="lang-python sourcecode" id="appendix-A-8">
<pre>
interior_manifest(data, segment, level, k, m, right_most_child)
  children = []
  if right_most_child is not None:
    children.append(right_most_child)

  interior_indirect(data, segment, level, k, m, children)
  interior_direct(data, segment, level, k, m, children)

  manifest = Manifest(children)
  return manifest, tail
</pre><a href="#appendix-A-8" class="pilcrow">¶</a>
</div>
<div class="lang-python sourcecode" id="appendix-A-9">
<pre>
interior_indirect(data, segment, level, k, m, children):
  # Reserve space at the head of the segment for this node's
  # direct pointers before descending to children.  We want
  # the top of the tree packed.
  reserve_count = min(k, segment.tail - segment.head)
  segment.head += reserve_count

  while len(children) &amp;lt; m and not segment.head == segment.tail:
    child = bottom_up_preorder(data, segment, level - 1, k, m)
    # prepend
    children.insert(0, child)

    # Pull back our reservation and put those pointers in
    # our direct children
    segment.head -= reserve_count
</pre><a href="#appendix-A-9" class="pilcrow">¶</a>
</div>
<div class="lang-python sourcecode" id="appendix-A-10">
<pre>
interior_direct(data, segment, level, k, m, children):
  while len(children) &amp;lt; k+m and not segment.head == segment.tail:
    pointer = data[segment.tail() - 1]
    children.insert(0, pointer)
    segment.tail -= 1
</pre><a href="#appendix-A-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christian Tschudin</span></div>
<div dir="auto" class="left"><span class="org">University of Basel</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:christian.tschudin@unibas.ch" class="email">christian.tschudin@unibas.ch</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marc Mosko</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marc@mosko.org" class="email">marc@mosko.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Oran (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Network Systems Research &amp; Design</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:daveoran@orandom.net" class="email">daveoran@orandom.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
